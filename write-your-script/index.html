<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>The heart: script - PyPPL - A Python PiPeLine framework</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../README/">PyPPL - A Python PiPeLine framework</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../README/">Introduction</a>
                    </li>
                    <li >
                        <a href="../basic-concepts-and-directory-structure/">Basics and folder structure</a>
                    </li>
                    <li >
                        <a href="../placeholders/">Templating</a>
                    </li>
                    <li >
                        <a href="../channels/">Channels</a>
                    </li>
                    <li >
                        <a href="../specify-input-and-output-of-a-process/">Input and output of a process</a>
                    </li>
                    <li class="active">
                        <a href="./">The heart: script</a>
                    </li>
                    <li >
                        <a href="../export-output-files/">Output file exporting</a>
                    </li>
                    <li >
                        <a href="../caching/">Caching and resuming processes</a>
                    </li>
                    <li >
                        <a href="../runners/">Runners</a>
                    </li>
                    <li >
                        <a href="../set-other-properties-of-a-process/">Other attributes of a process</a>
                    </li>
                    <li >
                        <a href="../configure-your-logs/">Log configuration</a>
                    </li>
                    <li >
                        <a href="../configure-a-pipeline/">Pipeline configuration</a>
                    </li>
                    <li >
                        <a href="../draw-flowchart-of-a-pipeline/">Pipeline flowchart</a>
                    </li>
                    <li >
                        <a href="../command-line-argument-parser/">Command line argument parser</a>
                    </li>
                    <li >
                        <a href="../aggregations/">Aggregations</a>
                    </li>
                    <li >
                        <a href="../command-line-tool/">Command line tool</a>
                    </li>
                    <li >
                        <a href="../api/">API</a>
                    </li>
                    <li >
                        <a href="../faq/">FAQ</a>
                    </li>
                    <li >
                        <a href="../change-log/">Change log</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../specify-input-and-output-of-a-process/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../export-output-files/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#write-and-debug-your-script">Write and debug your script</a></li>
            <li><a href="#choose-your-language">Choose your language</a></li>
            <li><a href="#use-script-from-a-file">Use script from a file</a></li>
            <li><a href="#debug-your-script">Debug your script</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="write-and-debug-your-script">Write and debug your script</h1>
<!-- toc -->

<h2 id="choose-your-language">Choose your language</h2>
<p>You can either specify the path of interpreter to <code>pXXX.lang</code>. If the interpreter is in <code>$PATH</code>, you can directly give the basename of the interpreter.<br />
For example, if you have your own perl installed at <code>/home/user/bin/perl</code>, then you need to tell <code>PyPPL</code> where it is: <code>pXXX.lang = "/home/user/bin/perl"</code>. If <code>/home/user/bin</code> is in your <code>$PATH</code>, you can simply do: <code>p.lang = "perl"</code><br />
You can also use <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a> to specify the interperter:</p>
<pre><code class="perl">#!/home/usr/bin/perl
# You perl code goes here
</code></pre>

<h2 id="use-script-from-a-file">Use script from a file</h2>
<p>You can also put the script into a file, and use it with a <code>file:</code> prefix: <code>pXXX.script = "file:/a/b/c.pl"</code>  </p>
<blockquote>
<p><strong>Note</strong>: You may also use a relative-path template, which is relative to where <code>pXXX.script</code> is defined. For example: <code>pXXX.script = "file:./scripts/script.py"</code> is defined in <code>/a/b/pipeline.py</code>, then the script file refers to <code>/a/b/scripts/script.py</code></p>
<p><strong>HINT</strong>: Indents are important in python, when you write your scripts, you have to follow exactly the indents in the script string, for example:</p>
</blockquote>
<pre><code class="python">def test():
    p = Proc()
    p.lang = &quot;python&quot;
    p.script = &quot;&quot;&quot;
import os
import re
def somefunc ():
    pass
&quot;&quot;&quot;
</code></pre>

<p>But with <code>'## indent remove ##'</code>, you can do it more elegantly:</p>
<pre><code class="python">def test():
    p = proc()
    p.lang = &quot;python&quot;
    p.script = &quot;&quot;&quot;
    # make sure it's not at the beginning of the file
    ## PYPPL INDENT REMOVE ## 
    import os
    import re
    def somefunc():
        pass
    &quot;&quot;&quot;
</code></pre>

<p>The leading white spaces of line <code>## indent remove ##</code> will be removed for each line (including itself) below it. In this case, the extra <code>&lt;tab&gt;</code> of pass will be kept.<br />
You may use <code>## indent keep ##</code> to stop removing the white spaces for the following lines.</p>
<blockquote>
<p><strong>Caution</strong> <code>## indent remove ##</code> Should not be at the beginning of the file, otherwise the leading spaces will be stripped so we can detect how many spaces should be removed for the following lines.</p>
</blockquote>
<h2 id="debug-your-script">Debug your script</h2>
<p>If you need to debug your script, you just need to find the real running script, which is at: <code>&lt;workdir&gt;/&lt;job.index&gt;/job.script</code>. The template is rendered already in the file. You can debug it using the tool according to the language you used for the script.</p>
<p>You may also add logs to pyppl's main logs on the screen or in log files. To do that, you just need to print you message starting with <code>pyppl.log</code> to STDERR:</p>
<pre><code class="python"># python
import sys
sys.stderr.write('pyppl.log: Something for debug.')
</code></pre>

<pre><code class="bash"># bash
echo &quot;pyppl.log: Something for debug.&quot; 1&gt;&amp;2
</code></pre>

<pre><code class="R"># Rscript
cat(&quot;pyppl.log: Something for debug.&quot;, file = stderr())
</code></pre>

<p>Either one of the above will have a log message like:</p>
<pre><code>[2017-01-01 01:01:01][    LOG] Something for debug.
</code></pre>

<p>You may also use a different log level (flag):</p>
<pre><code class="python"># python
import sys
sys.stderr.write('pyppl.log.flag: Something for debug.')
</code></pre>

<p>Then the log message will be:</p>
<pre><code>[2017-01-01 01:01:01][   FLAG] Something for debug.
</code></pre>

<blockquote>
<p><strong>NOTE</strong> The level name you specified after <code>pyppl.log</code> does not apply to <a href="https://pwwang.gitbooks.io/pyppl/configure-your-logs.html">normal log filters or themes</a>, because the actual level is <code>_FLAG</code> in this case. So unless you set <code>loglevels</code> to <code>None</code>, it will be anyway printed out. For themes, the color at the empty string key will be used. 
You can define filters or themes for this kind of logs, just remember the actual level name has an <code>_</code> prefix. See <a href="https://pwwang.gitbooks.io/pyppl/configure-your-logs.html">here</a> to learn how to define filters and themes.</p>
</blockquote></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
