<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Pipeline configuration - PyPPL - A Python PiPeLine framework</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../README/">PyPPL - A Python PiPeLine framework</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../README/">Introduction</a>
                    </li>
                    <li >
                        <a href="../basic-concepts-and-directory-structure/">Basics and folder structure</a>
                    </li>
                    <li >
                        <a href="../placeholders/">Templating</a>
                    </li>
                    <li >
                        <a href="../channels/">Channels</a>
                    </li>
                    <li >
                        <a href="../specify-input-and-output-of-a-process/">Input and output of a process</a>
                    </li>
                    <li >
                        <a href="../write-your-script/">The heart: script</a>
                    </li>
                    <li >
                        <a href="../export-output-files/">Output file exporting</a>
                    </li>
                    <li >
                        <a href="../caching/">Caching and resuming processes</a>
                    </li>
                    <li >
                        <a href="../runners/">Runners</a>
                    </li>
                    <li >
                        <a href="../set-other-properties-of-a-process/">Other attributes of a process</a>
                    </li>
                    <li >
                        <a href="../configure-your-logs/">Log configuration</a>
                    </li>
                    <li class="active">
                        <a href="./">Pipeline configuration</a>
                    </li>
                    <li >
                        <a href="../draw-flowchart-of-a-pipeline/">Pipeline flowchart</a>
                    </li>
                    <li >
                        <a href="../command-line-argument-parser/">Command line argument parser</a>
                    </li>
                    <li >
                        <a href="../aggregations/">Aggregations</a>
                    </li>
                    <li >
                        <a href="../command-line-tool/">Command line tool</a>
                    </li>
                    <li >
                        <a href="../api/">API</a>
                    </li>
                    <li >
                        <a href="../faq/">FAQ</a>
                    </li>
                    <li >
                        <a href="../change-log/">Change log</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../configure-your-logs/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../draw-flowchart-of-a-pipeline/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#configure-your-pipeline">Configure your pipeline</a></li>
            <li><a href="#use-a-configuration-file">Use a configuration file</a></li>
            <li><a href="#priority-of-configuration-options">Priority of configuration options</a></li>
            <li><a href="#starting-processes">Starting processes</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="configure-your-pipeline">Configure your pipeline</h1>
<!-- toc -->

<p>{% raw %}
To configure your pipeline, you just pass the configurations (a <code>dict</code>) to the constructor:</p>
<pre><code class="python">ppl = PyPPL(config)
</code></pre>

<p>Here is the full structure of the configurations (<strong><code>yaml</code> configuration file is also supported since <code>0.9.4</code></strong>):</p>
<pre><code class="json">{
    &quot;log&quot;: {
        &quot;levels&quot;: &quot;basic&quot;,  // the log levels
        &quot;theme&quot;: true,    // use colored log information
        &quot;lvldiff&quot;: [&quot;+DEBUG&quot;],  // modify the loglevels group
        &quot;file&quot;: false,    // disable logfile, or specify a different logfile
    },
    &quot;flowchart&quot;: {
        &quot;theme&quot;: &quot;default&quot;,
        &quot;dot&quot;: &quot;dot -Tsvg {{dotfile}} -o {{fcfile}}&quot;
    },
    &quot;proc&quot;: {            // shared configuration of processes
        &quot;forks&quot;: 10,
        &quot;runner&quot;: &quot;sge&quot;,
        &quot;sgeRunner&quot;: {
            // sge options
        }
    },
    &quot;profile1&quot; : {
        &quot;forks&quot;: 20,
        &quot;runner&quot;: &quot;ssh&quot;,
        &quot;sshRunner&quot;: {
            // ssh options
        }
    },
    &quot;profile2&quot;: {...},
    &quot;profile3&quot;: {...},
    ...
}
</code></pre>

<ul>
<li>For log configuration please refer to <a href="https://pwwang.gitbooks.io/pyppl/configure-your-logs.html">configure your logs</a></li>
<li>For flowchart configuration please refer to <a href="https://pwwang.gitbooks.io/pyppl/draw-flowchart-of-a-pipeline.html">pipeline flowchart</a></li>
<li><code>proc</code> defines the base running profile for processes in this pipeline. <a href="https://pwwang.gitbooks.io/pyppl/content/set-other-properties-of-a-process.html">All the properties</a> of a process can be set here, but just some common one are recommended. Obviously, <code>input</code> is not suitable to be set here, except some extreme cases.</li>
<li><code>profiles</code> defines some profiles that may be shared by the processes. To use a profile, just specify the profile name to <code>run</code>: <code>PyPPL(config).start(process).run(&lt;profile&gt;)</code>.</li>
</ul>
<blockquote>
<p><strong>Info</strong> Settings for <code>profiles</code> are actually the same as for <code>proc</code>. They just make you easy to switch the profiles back and forth. For example, you want to run with sge runner this time, but ssh runner next time, what you need to do is just change from <code>...run("profile_sge")</code> to <code>...run("profile_ssh")</code>
<strong>Note</strong> You may also use the runner name as a profile. That means, following profiles are implied in the configuration:</p>
</blockquote>
<pre><code class="json">{
    &quot;sge&quot;  : {&quot;runner&quot;: &quot;sge&quot;},
    &quot;ssh&quot;  : {&quot;runner&quot;: &quot;ssh&quot;},
    &quot;slurm&quot;: {&quot;runner&quot;: &quot;slurm&quot;},
    &quot;local&quot;: {&quot;runner&quot;: &quot;local&quot;},
    &quot;dry&quot;  : {&quot;runner&quot;: &quot;dry&quot;},
}
</code></pre>

<blockquote>
<p><strong>Caution</strong> You cannot define profiles with names <code>flowchart</code> and <code>log</code></p>
</blockquote>
<h2 id="use-a-configuration-file">Use a configuration file</h2>
<p><code>PyPPL</code> will look for configuration files at <code>~/.PyPPL</code> and <code>~/.PyPPL.json</code> if both or either of them exist. If both of them exist, <code>~/.PyPPL.json</code> has higher priority, which means the options will be overwritten in <code>~/.PyPPL</code> by those in <code>~/.PyPPL.json</code>. But to avoid confusion, you'd better just use either of them.</p>
<p>You can also use another configuration file explictly (say, <code>/a/b/pyppl.config.json</code>), and then specify it to <code>PyPPL</code> constructor:</p>
<pre><code class="python">PyPPL({}, &quot;/a/b/pyppl.config.json&quot;)
# or 
PyPPL (cfgfile = &quot;/a/b/pyppl.config.json&quot;)
</code></pre>

<p>In this case, <code>/a/b/pyppl.config.json</code> has the highest priority of all configuration files.
All other options will be inherited from <code>~/.PyPPL.json</code> and them <code>~/.PyPPL</code>.</p>
<h2 id="priority-of-configuration-options">Priority of configuration options</h2>
<p>Now you have 3 ways to set attributes for a process: 
- directly set the process attributes <em>(1)</em>, 
- set in the first argument (<code>config</code>) of <code>PyPPL</code> constructor <em>(2)</em>, 
- set in a configuration file <code>/a/b/pyppl.config.json</code> <em>(3)</em>,
- set in configuration file <code>~/.PyPPL.json</code> <em>(4)</em>, and
- set in configuration file <code>~/.PyPPL</code> <em>(5)</em></p>
<p><strong>The priority is: (1) &gt; (2) &gt; (3) &gt; (4) &gt; (5).</strong>
Once you set the property of the process, it will never be changed by <code>PyPPL</code> constructor or the configuration file. But the first argument can overwrite the options in configuration files.
Here are an examples to illustrate the priority:</p>
<p><strong> Example 1:</strong></p>
<pre><code class="python"># ~/.PyPPL.json
&quot;&quot;&quot;
{
    &quot;proc&quot;: {&quot;forks&quot;: 5}
}
&quot;&quot;&quot;

p = Proc()
p.forks = 1

ppl = PyPPL({&quot;proc&quot;: {forks: 10}})

# p.forks == 1
</code></pre>

<p><strong> Example 2:</strong></p>
<pre><code class="python"># we also have ~/.PyPPL.json as previous example
p = Proc()

ppl = PyPPL({&quot;proc&quot;: {forks: 10}})

# p.forks == 10
</code></pre>

<p><strong> Example 3:</strong></p>
<pre><code class="python"># we also have ~/.PyPPL.json as previous example
p = Proc()

ppl = PyPPL()

# p.forks == 5
</code></pre>

<h2 id="starting-processes">Starting processes</h2>
<p>It's very easy to set the starting processes of the pipeline, just pass them to <code>start</code> function. A pipeline can have multiple starting processes:</p>
<pre><code class="python">PyPPL().start(p1,p2,p3).run()
</code></pre>

<p>You may also use a common id to set a set of processes:</p>
<pre><code class="python">p1 = Proc(newid = 'p', tag = '1st')
p2 = Proc(newid = 'p', tag = '2nd')
p3 = Proc(newid = 'p', tag = '3rd')
# all p1, p2, p3 will be starting processes
PyPPL().start('p').run()
</code></pre>

<blockquote>
<p><strong>Caution</strong> 
1. If a process is depending on other processes, you are not supposed to set it as starting process. Of course you can, but make sure the input channel can be normally constructed.
2. If a process is not depending on any other processes, you have to set it as starting process. Otherwise, it won't start to run.</p>
</blockquote>
<p>{% endraw %}</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
