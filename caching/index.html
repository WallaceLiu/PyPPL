<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Caching and resuming processes - PyPPL</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Caching and resuming processes";
    var mkdocs_page_input_path = "caching.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> PyPPL</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../basic-concepts-and-directory-structure/">Basics and folder structure</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../placeholders/">Templating</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../channels/">Channels</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../specify-input-and-output-of-a-process/">Input and output of a process</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../write-your-script/">The heart: script</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../export-output-files/">Output file exporting</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Caching and resuming processes</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#caching-and-resuming-processes">Caching and resuming processes</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#process-caching">Process caching</a></li>
        
            <li><a class="toctree-l3" href="#resuming-from-processes">Resuming from processes</a></li>
        
            <li><a class="toctree-l3" href="#calculating-signatures-for-caching">Calculating signatures for caching</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../runners/">Runners and running profiles</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../error-handling/">Error handling of processes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../set-other-properties-of-a-process/">Other attributes of a process</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../configure-your-logs/">Log configuration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../draw-flowchart-of-a-pipeline/">Pipeline flowchart</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../configure-a-pipeline/">Pipeline configuration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../command-line-argument-parser/">Command line argument parser</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../aggregations/">Aggregations</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../command-line-tool/">Command line tool</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../api/">API</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../faq/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../change-log/">Change log</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">PyPPL</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Caching and resuming processes</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="caching-and-resuming-processes">Caching and resuming processes</h2>
<!-- toc -->

<h3 id="process-caching">Process caching</h3>
<p>Once a job is cached, <code>PyPPL</code> will skip running this job. But you have to tell a process how to cache its jobs by setting <code>pXXX.cache</code> with a valid caching method:</p>
<table>
<thead>
<tr>
<th>Caching method (<code>p.cache=?</code>)</th>
<th>How</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>True</code></td>
<td>A signature<sup>*</sup> of input files, script and output files of a job is cached in <code>&lt;workdir&gt;/&lt;job.index&gt;/job.cache</code>, compare the signature before a job starts to run.</td>
</tr>
<tr>
<td><code>False</code></td>
<td>Disable caching, always run jobs.</td>
</tr>
<tr>
<td><code>"export"</code></td>
<td>First try to find the signatures, if failed, try to restore the files existed (or exported previously in <code>p.exdir</code>).</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Hint</strong>: <code>p.cache = "export"</code> is extremely useful for a process that you only want it to run successfully once, export the result files and never run the process again. You can even delete the <code>&lt;workdir&gt;</code> of the process, but <code>PyPPL</code> will find the exported files and use them as the input for processes depending on it, so that you don't need to modify the pipeline.<br />
One scenario is that you can use it to download some files and never need to download them again.</p>
</blockquote>
<h3 id="resuming-from-processes">Resuming from processes</h3>
<p>Sometimes, you may not want to start at the very begining of a pipeline. Then you can resume it from some intermediate processes.<br />
To resume pipeline from a process, you have to make sure that the output files of the processes that this process depends on are already generated. Then you can do:
<div class="highlight"><pre><span></span><span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">resume</span><span class="p">(</span><span class="n">pXXX</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
Or if the process uses the data from other processes, especially the output channel, you may need <code>PyPPL</code> to infer (not neccessary run the script) the output data for processes that this process depends on. Then you can do:
<div class="highlight"><pre><span></span><span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">resume2</span><span class="p">(</span><span class="n">pXXX</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
You may also use a common id to set a set of processes:
<div class="highlight"><pre><span></span><span class="n">p1</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">newid</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;1st&#39;</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">newid</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;2nd&#39;</span><span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">newid</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;3rd&#39;</span><span class="p">)</span>
<span class="c1"># pipeline will be resumed from p1, p2, p3</span>
<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">resume</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div></p>
<h3 id="calculating-signatures-for-caching">Calculating signatures for caching</h3>
<p>By default, <code>PyPPL</code> uses the last modified time to generate signatures for files and directories. However, for large directories, it may take notably long time to walk over all the files in those directories. If not necessary, you may simply as <code>PyPPL</code> to get the last modified time for the directories themselves instead of the infiles inside them by setting <code>p.dirsig = False</code></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../runners/" class="btn btn-neutral float-right" title="Runners and running profiles">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../export-output-files/" class="btn btn-neutral" title="Output file exporting"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../export-output-files/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../runners/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
