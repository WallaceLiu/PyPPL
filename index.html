<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="None">
  
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Introduction - PyPPL</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="css/theme.css" type="text/css" />
  <link rel="stylesheet" href="css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Introduction";
    var mkdocs_page_input_path = "index.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> PyPPL</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1 current">
		
    <a class="current" href=".">Introduction</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#pyppl-a-python-pipeline-framework">PyPPL - A Python PiPeLine framework</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#features">Features</a></li>
        
            <li><a class="toctree-l3" href="#requirements">Requirements</a></li>
        
            <li><a class="toctree-l3" href="#installation">Installation</a></li>
        
            <li><a class="toctree-l3" href="#get-started">Get started</a></li>
        
            <li><a class="toctree-l3" href="#infer-input-channel-from-dependent-process">Infer input channel from dependent process</a></li>
        
            <li><a class="toctree-l3" href="#modify-input-channel">Modify input channel</a></li>
        
            <li><a class="toctree-l3" href="#use-a-different-language">Use a different language</a></li>
        
            <li><a class="toctree-l3" href="#use-args">Use args</a></li>
        
            <li><a class="toctree-l3" href="#use-the-command-line-argument-parser">Use the command line argument parser</a></li>
        
            <li><a class="toctree-l3" href="#use-a-different-runner">Use a different runner</a></li>
        
            <li><a class="toctree-l3" href="#use-jinja2-as-template-engine">Use Jinja2 as template engine</a></li>
        
            <li><a class="toctree-l3" href="#debug-your-script">Debug your script</a></li>
        
            <li><a class="toctree-l3" href="#switch-runner-profiles">Switch runner profiles</a></li>
        
            <li><a class="toctree-l3" href="#draw-the-pipeline-chart">Draw the pipeline chart</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="basic-concepts-and-directory-structure/">Basics and folder structure</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="placeholders/">Templating</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="channels/">Channels</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="specify-input-and-output-of-a-process/">Input and output of a process</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="write-your-script/">The heart: script</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="export-output-files/">Output file exporting</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="caching/">Caching and resuming processes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="runners/">Runners and running profiles</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="error-handling/">Error handling of processes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="set-other-properties-of-a-process/">Other attributes of a process</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="configure-your-logs/">Log configuration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="draw-flowchart-of-a-pipeline/">Pipeline flowchart</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="configure-a-pipeline/">Pipeline configuration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="command-line-argument-parser/">Command line argument parser</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="aggregations/">Aggregations</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="command-line-tool/">Command line tool</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="api/">API</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="faq/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="change-log/">Change log</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">PyPPL</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Introduction</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="pyppl-a-python-pipeline-framework"><a href="https://github.com/pwwang/pyppl/">PyPPL</a> - A <a href="#">Py</a>thon <a href="#">P</a>i<a href="#">P</a>e<a href="#">L</a>ine framework</h1>
<p><img alt="Pypi" src="https://img.shields.io/pypi/v/pyppl.svg?style=flat-square" /> <img alt="Github" src="https://img.shields.io/github/tag/pwwang/PyPPL.svg?style=flat-square" /> <img alt="PythonVers" src="https://img.shields.io/pypi/pyversions/PyPPL.svg?style=flat-square" /> <img alt="Codacy" src="https://img.shields.io/codacy/grade/a04aac445f384a8dbe47da19c779763f.svg?style=flat-square" /> <img alt="Codacy coverage" src="https://img.shields.io/codacy/coverage/a04aac445f384a8dbe47da19c779763f.svg?style=flat-square" /> <img alt="Travis building" src="https://img.shields.io/travis/pwwang/PyPPL.svg?style=flat-square" /> <img alt="License" src="https://img.shields.io/github/license/pwwang/PyPPL.svg?style=flat-square" /></p>
<p><a href="https://pwwang.github.io/PyPPL/">Documentation</a> | <a href="https://pwwang.github.io/PyPPL/api/">API</a> | <a href="https://pwwang.github.io/PyPPL/change-log/">Change log</a> | <a href="https://pwwang.github.io/PyPPL/faq/">FAQ</a></p>
<!-- toc -->

<h2 id="features">Features</h2>
<ul>
<li><a href="https://pwwang.github.io/PyPPL/command-line-argument-parser/">Easy-to-use command line parser.</a></li>
<li><a href="https://pwwang.github.io/PyPPL/configure-your-logs/">Fancy logs.</a></li>
<li><a href="https://pwwang.github.io/PyPPL/caching/">Process caching.</a></li>
<li><a href="https://pwwang.github.io/PyPPL/placeholders/">Script templating (using either builtin engine or Jinja2).</a></li>
<li><a href="https://pwwang.github.io/PyPPL/runners/">Runner customization</a>.</li>
<li><a href="https://pwwang.github.io/PyPPL/error-handling/">Error handling for processes.</a></li>
<li><a href="https://pwwang.github.io/PyPPL/runners/">Easy-switching running profile.</a></li>
<li>Flowchat in <a href="https://en.wikipedia.org/wiki/DOT_(graph_description_language)">DOT</a> for your pipelines (<a href="https://pwwang.github.io/PyPPL/draw-flowchart-of-a-pipeline/">Details</a>).</li>
<li><a href="https://pwwang.github.io/PyPPL/aggregations/">Aggregations (a set of processes predefined).</a></li>
<li>Highly reusable processes (see <a href="https://github.com/pwwang/bioprocs">a set of highly reusable bioinformatics processes</a>).</li>
</ul>
<h2 id="requirements">Requirements</h2>
<ul>
<li>OS: Linux or OSX</li>
<li>Python packages: <a href="https://github.com/benjaminp/six">six</a>, <a href="https://github.com/benediktschmitt/py-filelock">filelock</a>, <a href="https://pypi.org/project/futures/">futures</a> (suggested: <a href="https://github.com/xflr6/graphviz">graphviz</a>, <a href="https://github.com/yaml/pyyaml">pyyaml</a> and <a href="https://github.com/pwwang/testly">python-testly</a>).</li>
</ul>
<h2 id="installation">Installation</h2>
<div class="highlight"><pre><span></span><span class="c1"># install latest version</span>
git clone https://github.com/pwwang/PyPPL.git
<span class="nb">cd</span> PyPPL
python setup.py install
<span class="c1"># or simply:</span>
pip install git+git://github.com/pwwang/PyPPL.git

<span class="c1"># install released version</span>
pip install PyPPL

<span class="c1"># run tests </span>
pip install python-testly
<span class="c1"># or pip install git+git://github.com/pwwang/testly.git</span>
make <span class="nb">test</span>

<span class="c1"># run tests only for python2</span>
make test2

<span class="c1"># run tests only for python3</span>
make test3

<span class="c1"># run tutorials</span>
make tutorials
</pre></div>

<h2 id="get-started">Get started</h2>
<p>See <code>tutorials/getStarted/</code><br />
Sort 5 files simultaneously: 
<div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">Channel</span>

<span class="mf">2.</span> <span class="n">pSort</span>         <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Sort files.&#39;</span><span class="p">)</span>
<span class="mf">3.</span> <span class="n">pSort</span><span class="o">.</span><span class="n">input</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infile:file&quot;</span><span class="p">:</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPattern</span><span class="p">(</span><span class="s2">&quot;./data/*.txt&quot;</span><span class="p">)}</span>
<span class="mf">4.</span> <span class="n">pSort</span><span class="o">.</span><span class="n">output</span>  <span class="o">=</span> <span class="s2">&quot;outfile:file:{{in.infile | fn}}.sorted&quot;</span>
<span class="mf">5.</span> <span class="n">pSort</span><span class="o">.</span><span class="n">forks</span>   <span class="o">=</span> <span class="mi">5</span>
<span class="mf">6.</span> <span class="n">pSort</span><span class="o">.</span><span class="n">exdir</span>   <span class="o">=</span> <span class="s1">&#39;./export&#39;</span>
<span class="mf">7.</span> <span class="n">pSort</span><span class="o">.</span><span class="n">script</span>  <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  sort -k1r {{in.infile}} &gt; {{out.outfile}} </span>
<span class="s2">&quot;&quot;&quot;</span> 

<span class="mf">8.</span> <span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pSort</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div></p>
<p><strong>Line 1</strong>: Import the modules.<br />
<strong>Line 2</strong>: Define the process with a description.<br />
<strong>Line 3</strong>: Define the input data for the process.<br />
<strong>Line 4</strong>: Define the output. Templates are also applied here.<br />
<strong>Line 5</strong>: Define how many jobs are running simultaneously.<br />
<strong>Line 6</strong>: Set the directory to export the output files.<br />
<strong>Line 7</strong>: Set your script to run.<br />
<strong>Line 8</strong>: Set the starting process and run the pipeline.  </p>
<p><img alt="getStarted" src="https://raw.githubusercontent.com/pwwang/PyPPL/master/docs/getStarted.png" />
<div class="highlight"><pre><span></span>&gt; ls -l ./export
total 0
-rw-rw-rw- 1 pwwang pwwang 44 Sep 14 20:50 test1.sorted
-rw-rw-rw- 1 pwwang pwwang 56 Sep 14 20:50 test2.sorted
-rw-rw-rw- 1 pwwang pwwang 59 Sep 14 20:50 test3.sorted
-rw-rw-rw- 1 pwwang pwwang 58 Sep 14 20:50 test4.sorted
-rw-rw-rw- 1 pwwang pwwang 58 Sep 14 20:50 test5.sorted
</pre></div></p>
<h2 id="infer-input-channel-from-dependent-process">Infer input channel from dependent process</h2>
<p>See <code>tutorials/inputFromDependent/</code><br />
If a process depends on another one, the input channel can be inferred from the output channel of the latter process.<br />
Sort 5 files and then add line number to each line.
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">Channel</span>

<span class="n">pSort</span>        <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Sort files.&#39;</span><span class="p">)</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">input</span>  <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infile:file&quot;</span><span class="p">:</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPattern</span><span class="p">(</span><span class="s2">&quot;./data/*.txt&quot;</span><span class="p">)}</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;outfile:file:{{in.infile | fn}}.sorted&quot;</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">forks</span>  <span class="o">=</span> <span class="mi">5</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  sort -k1r {{in.infile}} &gt; {{out.outfile}} </span>
<span class="s2">&quot;&quot;&quot;</span> 

<span class="n">pAddPrefix</span>         <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Add line number to each line.&#39;</span><span class="p">)</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">pSort</span>
<span class="c1"># automatically inferred from pSort.output</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">input</span>   <span class="o">=</span> <span class="s2">&quot;infile:file&quot;</span>  
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">output</span>  <span class="o">=</span> <span class="s2">&quot;outfile:file:{{in.infile | fn}}.ln&quot;</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">exdir</span>   <span class="o">=</span> <span class="s1">&#39;./export&#39;</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">forks</span>   <span class="o">=</span> <span class="mi">5</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">script</span>  <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">paste -d. &lt;(seq 1 $(wc -l {{in.infile}} | cut -f1 -d&#39; &#39;)) {{in.infile}} &gt; {{out.outfile}}</span>
<span class="s2">&quot;&quot;&quot;</span> 

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pSort</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
<div class="highlight"><pre><span></span>&gt; head -3 ./export/test1.ln
1.8984
2.663
3.625
</pre></div></p>
<h2 id="modify-input-channel">Modify input channel</h2>
<p>See <code>tutorials/transformInputChannels/</code><br />
Sort 5 files, add line numbers, and merge them into one file.
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">Channel</span>

<span class="n">pSort</span>        <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Sort files.&#39;</span><span class="p">)</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">input</span>  <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infile:file&quot;</span><span class="p">:</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPattern</span><span class="p">(</span><span class="s2">&quot;./data/*.txt&quot;</span><span class="p">)}</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;outfile:file:{{in.infile | fn}}.sorted&quot;</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">forks</span>  <span class="o">=</span> <span class="mi">5</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  sort -k1r {{in.infile}} &gt; {{out.outfile}} </span>
<span class="s2">&quot;&quot;&quot;</span> 

<span class="n">pAddPrefix</span>         <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Add line number to each line.&#39;</span><span class="p">)</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">pSort</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">input</span>   <span class="o">=</span> <span class="s2">&quot;infile:file&quot;</span>  <span class="c1"># automatically inferred from pSort.output</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">output</span>  <span class="o">=</span> <span class="s2">&quot;outfile:file:{{in.infile | fn}}.ln&quot;</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">forks</span>   <span class="o">=</span> <span class="mi">5</span>
<span class="n">pAddPrefix</span><span class="o">.</span><span class="n">script</span>  <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">paste -d. &lt;(seq 1 $(wc -l {{in.infile}} | cut -f1 -d&#39; &#39;)) {{in.infile}} &gt; {{out.outfile}}</span>
<span class="s2">&quot;&quot;&quot;</span> 

<span class="n">pMergeFiles</span>         <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Merge files, each as a column.&#39;</span><span class="p">)</span>
<span class="n">pMergeFiles</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">pAddPrefix</span>
<span class="c1"># Transform it into a list of files</span>
<span class="c1"># [&quot;test1.ln&quot;, &quot;test2.ln&quot;, ..., &quot;test5.ln&quot;]</span>
<span class="n">pMergeFiles</span><span class="o">.</span><span class="n">input</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infiles:files&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">ch</span><span class="p">:</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]}</span>
<span class="n">pMergeFiles</span><span class="o">.</span><span class="n">output</span>  <span class="o">=</span> <span class="s2">&quot;outfile:file:mergedfile.txt&quot;</span>
<span class="n">pMergeFiles</span><span class="o">.</span><span class="n">exdir</span>   <span class="o">=</span> <span class="s2">&quot;./export&quot;</span>
<span class="n">pMergeFiles</span><span class="o">.</span><span class="n">script</span>  <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">paste {{in.infiles | asquote}} &gt; {{out.outfile}}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pSort</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
<div class="highlight"><pre><span></span>&gt; head -3 ./export/mergedfile.txt
1.8984  1.6448  1.2915  1.7269  1.7692
2.663   2.3369  2.26223 2.3866  2.7536
3.625   3.28984 3.25945 3.29971 3.30204
</pre></div></p>
<h2 id="use-a-different-language">Use a different language</h2>
<p>See <code>tutorials/differentLang/</code><br />
Plot heatmap using R.
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span>

<span class="n">pHeatmap</span>        <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Draw heatmap.&#39;</span><span class="p">)</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">input</span>  <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">8525</span><span class="p">}</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;outfile:file:heatmap.png&quot;</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">exdir</span>  <span class="o">=</span> <span class="s1">&#39;./export&#39;</span>
<span class="c1"># Use full path &quot;/path/to/Rscript&quot; if it&#39;s not in $PATH</span>
<span class="c1"># You can also use a shebang in script</span>
<span class="c1"># in this case: #!/usr/bin/env Rscript</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">lang</span>   <span class="o">=</span> <span class="s1">&#39;Rscript&#39;</span> 
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">set.seed({{in.seed}})</span>
<span class="s2">mat = matrix(rnorm(100), ncol=10)</span>
<span class="s2">png(filename = &quot;{{out.outfile}}&quot;)</span>
<span class="s2">heatmap(mat)</span>
<span class="s2">dev.off()</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pHeatmap</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
<code>./export/heatmap.png</code><br />
<img alt="heatmap.png" src="https://raw.githubusercontent.com/pwwang/PyPPL/master/docs/heatmap.png" /></p>
<h2 id="use-args">Use args</h2>
<p>See <code>tutorials/useArgs/</code><br />
If the jobs are sharing the same set of configurations (in this case, the number of rows and columns of the matrix), they can be set in <code>pXXX.args</code>. The other benefit is to make the channels intact if the configurations are not suppose to be channeling.<br />
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span>

<span class="n">pHeatmap</span>           <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Draw heatmap.&#39;</span><span class="p">)</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">input</span>     <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]}</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">output</span>    <span class="o">=</span> <span class="s2">&quot;outfile:file:heatmap{{in.seed}}.png&quot;</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">exdir</span>     <span class="o">=</span> <span class="s2">&quot;./export&quot;</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">forks</span>     <span class="o">=</span> <span class="mi">3</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">ncol</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">nrow</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">lang</span>      <span class="o">=</span> <span class="s1">&#39;Rscript&#39;</span> <span class="c1"># or /path/to/Rscript if it&#39;s not in $PATH</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">set.seed({{in.seed}})</span>
<span class="s2">mat = matrix(rnorm({{args.ncol, args.nrow | lambda x, y: x*y}}), ncol={{args.ncol}})</span>
<span class="s2">png(filename = &quot;{{out.outfile}}&quot;, width=150, height=150)</span>
<span class="s2">heatmap(mat)</span>
<span class="s2">dev.off()</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pHeatmap</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div></p>
<table>
<thead>
<tr>
<th><code>./export/heatmap1.png</code></th>
<th><code>./export/heatmap2.png</code></th>
<th><code>./export/heatmap3.png</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="heatmap1.png" src="https://raw.githubusercontent.com/pwwang/PyPPL/master/docs/heatmap1.png" /></td>
<td><img alt="heatmap2.png" src="https://raw.githubusercontent.com/pwwang/PyPPL/master/docs/heatmap2.png" /></td>
<td><img alt="heatmap3.png" src="https://raw.githubusercontent.com/pwwang/PyPPL/master/docs/heatmap3.png" /></td>
</tr>
</tbody>
</table>
<h2 id="use-the-command-line-argument-parser">Use the command line argument parser</h2>
<p>See <code>tutorials/useParams/</code><br />
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="n">params</span>

<span class="n">params</span><span class="o">.</span><span class="n">datadir</span>    \
  <span class="o">.</span><span class="n">setRequired</span><span class="p">()</span>  \
  <span class="o">.</span><span class="n">setDesc</span><span class="p">(</span><span class="s1">&#39;The data directory containing the data files.&#39;</span><span class="p">)</span>

<span class="c1"># or</span>
<span class="c1"># params.datadir.required = True</span>
<span class="c1"># params.datadir.desc     = &#39;The data directory containing the data files.&#39;</span>

<span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>

<span class="n">pSort</span>         <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Sort files.&#39;</span><span class="p">)</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">input</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infile:file&quot;</span><span class="p">:</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPattern</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">datadir</span> <span class="o">+</span> <span class="s1">&#39;/*.txt&#39;</span><span class="p">)}</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">output</span>  <span class="o">=</span> <span class="s2">&quot;outfile:file:{{in.infile | fn}}.sorted&quot;</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">forks</span>   <span class="o">=</span> <span class="mi">5</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">exdir</span>   <span class="o">=</span> <span class="s1">&#39;./export&#39;</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">script</span>  <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  sort -k1r {{in.infile}} &gt; {{out.outfile}} </span>
<span class="s2">&quot;&quot;&quot;</span> 

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pSort</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
Run the pipeline:<br />
<code>&gt; python useParams.py</code>
<div class="highlight"><pre><span></span>USAGE:
  useParams.py -datadir &lt;str&gt;

REQUIRED OPTIONS:
  -datadir &lt;str&gt;                        The data directory containing the data files.

OPTIONAL OPTIONS:
  -h, --help, -H, -?                    Print this help information.
</pre></div>
Provide value to <code>-datadir</code>:<br />
<code>&gt; python useParams.py -datadir ./data</code></p>
<h2 id="use-a-different-runner">Use a different runner</h2>
<p>See <code>/tutorials/differentRunner/</code>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">Channel</span>

<span class="n">pSort</span>         <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Sort files.&#39;</span><span class="p">)</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">input</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infile:file&quot;</span><span class="p">:</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPattern</span><span class="p">(</span><span class="s2">&quot;./data/*.txt&quot;</span><span class="p">)}</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">output</span>  <span class="o">=</span> <span class="s2">&quot;outfile:file:{{in.infile | fn}}.sorted&quot;</span>
<span class="c1"># specify the runner</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">runner</span>  <span class="o">=</span> <span class="s1">&#39;sge&#39;</span>
<span class="c1"># specify the runner options</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">sgeRunner</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s2">&quot;sge.q&quot;</span> <span class="p">:</span> <span class="s2">&quot;1-day&quot;</span>
<span class="p">}</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">forks</span>   <span class="o">=</span> <span class="mi">5</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">exdir</span>   <span class="o">=</span> <span class="s1">&#39;./export&#39;</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">script</span>  <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  sort -k1r {{in.infile}} &gt; {{out.outfile}} </span>
<span class="s2">&quot;&quot;&quot;</span> 

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pSort</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># or run all process with sge runner:</span>
<span class="c1"># PyPPL().start(pSort).run(&#39;sge&#39;)</span>
<span class="c1"># or:</span>
<span class="c1"># PyPPL({</span>
<span class="c1">#   &#39;default&#39;: {</span>
<span class="c1">#       &#39;runner&#39;: &#39;sge&#39;, </span>
<span class="c1">#       &#39;sgeRunner&#39;: {&#39;sge.q&#39;: &#39;1-day&#39;}</span>
<span class="c1">#   }</span>
<span class="c1"># }).start(pSort).run()</span>
</pre></div></p>
<h2 id="use-jinja2-as-template-engine">Use Jinja2 as template engine</h2>
<p>See <code>/tutorials/useJinja2/</code>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span><span class="p">,</span> <span class="n">Channel</span>

<span class="n">pSort</span>          <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Sort files.&#39;</span><span class="p">)</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">input</span>    <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infile:file&quot;</span><span class="p">:</span> <span class="n">Channel</span><span class="o">.</span><span class="n">fromPattern</span><span class="p">(</span><span class="s2">&quot;./data/*.txt&quot;</span><span class="p">)}</span>
<span class="c1"># Notice the different between builtin template engine and Jinja2</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">output</span>   <span class="o">=</span> <span class="s2">&quot;outfile:file:{{ fn(in.infile) }}.sorted&quot;</span>
<span class="c1"># pSort.output = &quot;outfile:file:{{in.infile | fn}}.sorted&quot;</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">forks</span>    <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># You have to have Jinja2 installed (pip install Jinja2)</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;Jinja2&#39;</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">exdir</span>    <span class="o">=</span> <span class="s1">&#39;./export&#39;</span>
<span class="n">pSort</span><span class="o">.</span><span class="n">script</span>   <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  sort -k1r {{in.infile}} &gt; {{out.outfile}} </span>
<span class="s2">&quot;&quot;&quot;</span> 

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pSort</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div></p>
<h2 id="debug-your-script">Debug your script</h2>
<p>See <code>/tutorials/debugScript/</code><br />
You can directly go to <code>&lt;workdir&gt;/&lt;job.index&gt;/job.script</code> to debug your script, or you can also print some values out throught <code>PyPPL</code> log system.<br />
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span>

<span class="n">pHeatmap</span>           <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;Draw heatmap.&#39;</span><span class="p">)</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">input</span>     <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]}</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">output</span>    <span class="o">=</span> <span class="s2">&quot;outfile:file:heatmap{{in.seed}}.png&quot;</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">exdir</span>     <span class="o">=</span> <span class="s2">&quot;./export&quot;</span>
<span class="c1"># Don&#39;t cache jobs for debugging</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">cache</span>     <span class="o">=</span> <span class="bp">False</span>
<span class="c1"># Output debug information for all jobs, but don&#39;t echo stdout and stderr</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">echo</span>      <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;jobs&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">ncol</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">nrow</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">lang</span>      <span class="o">=</span> <span class="s1">&#39;Rscript&#39;</span> <span class="c1"># or /path/to/Rscript if it&#39;s not in $PATH</span>
<span class="n">pHeatmap</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">set.seed({{in.seed}})</span>
<span class="s2">mat = matrix(rnorm({{args.ncol, args.nrow | lambda x, y: x*y}}), ncol={{args.ncol}})</span>
<span class="s2">png(filename = &quot;{{out.outfile}}&quot;, width=150, height=150)</span>

<span class="s2"># have to be on stderr</span>
<span class="s2">cat(&quot;pyppl.log.debug:Plotting heatmap #{{job.index | lambda x: int(x) + 1}} ...&quot;, file = stderr())</span>

<span class="s2">heatmap(mat)</span>
<span class="s2">dev.off()</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">PyPPL</span><span class="p">({</span>
	<span class="s1">&#39;_log&#39;</span><span class="p">:</span> <span class="p">{</span>
		<span class="s1">&#39;levels&#39;</span> <span class="p">:</span> <span class="s1">&#39;basic&#39;</span><span class="p">,</span>
		<span class="s1">&#39;lvldiff&#39;</span><span class="p">:</span> <span class="p">[]</span>
	<span class="p">}</span>
<span class="p">})</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pHeatmap</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
You will get something like this in your log:
<img alt="debugScript.png" src="https://raw.githubusercontent.com/pwwang/PyPPL/master/docs/debugScript.png" /></p>
<h2 id="switch-runner-profiles">Switch runner profiles</h2>
<p>See <code>tutorials/siwthcRunnerProfile/</code><br />
We can define a set of runner profiles in a <code>json</code> file (<code>./profiles.json</code>):</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;runner&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="nt">&quot;forks&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;sgeRunner&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;sge.q&quot;</span><span class="p">:</span> <span class="s2">&quot;1-day&quot;</span>
    <span class="p">}</span> 
  <span class="p">},</span>
  <span class="nt">&quot;local5&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;runner&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="nt">&quot;forks&quot;</span><span class="p">:</span>  <span class="mi">5</span>
  <span class="p">},</span>
  <span class="nt">&quot;sge7days&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;runner&quot;</span><span class="p">:</span> <span class="s2">&quot;sge&quot;</span><span class="p">,</span>
    <span class="nt">&quot;sgeRunner&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;sge.q&quot;</span><span class="p">:</span> <span class="s2">&quot;7-days&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>or you can also use <code>.yaml</code>(<code>pyyaml</code> is required) file:
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">runner</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="l l-Scalar l-Scalar-Plain">forks</span> <span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="l l-Scalar l-Scalar-Plain">sgeRunner</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">sge.q</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1-day</span>
<span class="l l-Scalar l-Scalar-Plain">local5</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">runner</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="l l-Scalar l-Scalar-Plain">forks</span> <span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="l l-Scalar l-Scalar-Plain">sge7days</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">runner</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="l l-Scalar l-Scalar-Plain">sgeRunner</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">sge.q</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">7-days</span>
</pre></div></p>
<p>To switch profile:
<div class="highlight"><pre><span></span><span class="c1"># default profile (default)</span>
<span class="n">PyPPL</span><span class="p">(</span><span class="n">cfgfile</span> <span class="o">=</span> <span class="s2">&quot;./profiles.json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pHeatmap</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># switch to local5 or sge7days:</span>
<span class="c1"># PyPPL(cfgfile = &quot;./profiles.json&quot;).start(pHeatmap).run(&#39;local5&#39;)</span>
<span class="c1"># PyPPL(cfgfile = &quot;./profiles.json&quot;).start(pHeatmap).run(&#39;sge7days&#39;)</span>

<span class="c1"># You may also use runner name as profile, which means to run using the runner with default options:</span>
<span class="c1"># PyPPL(cfgfile = &quot;./profiles.json&quot;).start(pHeatmap).run(&#39;sge&#39;) # use 1-day queue</span>
</pre></div></p>
<h2 id="draw-the-pipeline-chart">Draw the pipeline chart</h2>
<p><code>PyPPL</code> can generate the graph in <a href="https://en.wikipedia.org/wiki/DOT_(graph_description_language)">DOT language</a>. 
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">PyPPL</span><span class="p">,</span> <span class="n">Proc</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="n">p4</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="n">p5</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="n">p6</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="n">p7</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="n">p8</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="n">p9</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		   p1         p8</span>
<span class="sd">		/      \      /</span>
<span class="sd">	 p2           p3</span>
<span class="sd">		\      /</span>
<span class="sd">		   p4         p9</span>
<span class="sd">		/      \      /</span>
<span class="sd">	 p5          p6 (export)</span>
<span class="sd">		\      /</span>
<span class="sd">		  p7 (export)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">p2</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p1</span>
<span class="n">p3</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p8</span>
<span class="n">p4</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span>
<span class="n">p4</span><span class="o">.</span><span class="n">exdir</span>   <span class="o">=</span> <span class="s2">&quot;./export&quot;</span>
<span class="n">p5</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p4</span>
<span class="n">p6</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p4</span><span class="p">,</span> <span class="n">p9</span>
<span class="n">p6</span><span class="o">.</span><span class="n">exdir</span>   <span class="o">=</span> <span class="s2">&quot;./export&quot;</span>
<span class="n">p7</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p5</span><span class="p">,</span> <span class="n">p6</span>
<span class="n">p7</span><span class="o">.</span><span class="n">exdir</span>   <span class="o">=</span> <span class="s2">&quot;./export&quot;</span>

<span class="c1"># make sure at least one job is created.</span>
<span class="n">p1</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
<span class="n">p8</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
<span class="n">p9</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}</span>

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p8</span><span class="p">,</span> <span class="n">p9</span><span class="p">)</span><span class="o">.</span><span class="n">flowchart</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
<code>drawFlowchart.pyppl.dot</code>:
<div class="highlight"><pre><span></span>digraph PyPPL {
    &quot;p8&quot; [color=&quot;#259229&quot; fillcolor=&quot;#ffffff&quot; fontcolor=&quot;#000000&quot; shape=&quot;box&quot; style=&quot;filled&quot;]
    &quot;p1&quot; [color=&quot;#259229&quot; fillcolor=&quot;#ffffff&quot; fontcolor=&quot;#000000&quot; shape=&quot;box&quot; style=&quot;filled&quot;]
    &quot;p9&quot; [color=&quot;#259229&quot; fillcolor=&quot;#ffffff&quot; fontcolor=&quot;#000000&quot; shape=&quot;box&quot; style=&quot;filled&quot;]
    &quot;p7&quot; [color=&quot;#d63125&quot; fillcolor=&quot;#ffffff&quot; fontcolor=&quot;#c71be4&quot; shape=&quot;box&quot; style=&quot;filled&quot;]
    &quot;p5&quot; [color=&quot;#000000&quot; fillcolor=&quot;#ffffff&quot; fontcolor=&quot;#000000&quot; shape=&quot;box&quot; style=&quot;rounded,filled&quot;]
    &quot;p4&quot; [color=&quot;#000000&quot; fillcolor=&quot;#ffffff&quot; fontcolor=&quot;#c71be4&quot; shape=&quot;box&quot; style=&quot;rounded,filled&quot;]
    &quot;p2&quot; [color=&quot;#000000&quot; fillcolor=&quot;#ffffff&quot; fontcolor=&quot;#000000&quot; shape=&quot;box&quot; style=&quot;rounded,filled&quot;]
    &quot;p3&quot; [color=&quot;#000000&quot; fillcolor=&quot;#ffffff&quot; fontcolor=&quot;#000000&quot; shape=&quot;box&quot; style=&quot;rounded,filled&quot;]
    &quot;p6&quot; [color=&quot;#000000&quot; fillcolor=&quot;#ffffff&quot; fontcolor=&quot;#c71be4&quot; shape=&quot;box&quot; style=&quot;rounded,filled&quot;]
    &quot;p2&quot; -&gt; &quot;p4&quot;
    &quot;p3&quot; -&gt; &quot;p4&quot;
    &quot;p1&quot; -&gt; &quot;p2&quot;
    &quot;p1&quot; -&gt; &quot;p3&quot;
    &quot;p6&quot; -&gt; &quot;p7&quot;
    &quot;p4&quot; -&gt; &quot;p5&quot;
    &quot;p4&quot; -&gt; &quot;p6&quot;
    &quot;p5&quot; -&gt; &quot;p7&quot;
    &quot;p8&quot; -&gt; &quot;p3&quot;
    &quot;p9&quot; -&gt; &quot;p6&quot;
}
</pre></div></p>
<p>To generate svg file, you have to have <a href="https://github.com/xflr6/graphviz">graphviz</a> installed.<br />
<code>drawFlowchart.pyppl.svg</code>:<br />
<img alt="PyPPL chart" src="https://raw.githubusercontent.com/pwwang/PyPPL/master/docs/drawFlowchart_pyppl.png" /></p>
<p><strong><em>Enjoy pipelining!!!</em></strong></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="basic-concepts-and-directory-structure/" class="btn btn-neutral float-right" title="Basics and folder structure">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
        <span style="margin-left: 15px"><a href="basic-concepts-and-directory-structure/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>

</body>
</html>

<!--
MkDocs version : 1.0.3
Build Date UTC : 2018-08-30 21:41:20
-->
