



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Aggregations - PyPPL</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.572ca0f0.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#initialize-an-aggregation" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="PyPPL" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                PyPPL
              </span>
              <span class="md-header-nav__topic">
                Aggregations
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="PyPPL" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    PyPPL
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../basic-concepts-and-directory-structure/" title="Basics and folder structure" class="md-nav__link">
      Basics and folder structure
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../placeholders/" title="Templating" class="md-nav__link">
      Templating
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../channels/" title="Channels" class="md-nav__link">
      Channels
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../specify-input-and-output-of-a-process/" title="Input and output of a process" class="md-nav__link">
      Input and output of a process
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../write-your-script/" title="The heart: script" class="md-nav__link">
      The heart: script
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../export-output-files/" title="Output file exporting" class="md-nav__link">
      Output file exporting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../caching/" title="Caching and resuming processes" class="md-nav__link">
      Caching and resuming processes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../runners/" title="Runners and running profiles" class="md-nav__link">
      Runners and running profiles
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../error-handling/" title="Error handling of processes" class="md-nav__link">
      Error handling of processes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../set-other-properties-of-a-process/" title="Other attributes of a process" class="md-nav__link">
      Other attributes of a process
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configure-your-logs/" title="Log configuration" class="md-nav__link">
      Log configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../draw-flowchart-of-a-pipeline/" title="Pipeline flowchart" class="md-nav__link">
      Pipeline flowchart
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configure-a-pipeline/" title="Pipeline configuration" class="md-nav__link">
      Pipeline configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../command-line-argument-parser/" title="Command line argument parser" class="md-nav__link">
      Command line argument parser
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Aggregations
      </label>
    
    <a href="./" title="Aggregations" class="md-nav__link md-nav__link--active">
      Aggregations
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initialize-an-aggregation" title="Initialize an aggregation" class="md-nav__link">
    Initialize an aggregation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-a-process-on-the-run" title="Add a process on the run" class="md-nav__link">
    Add a process on the run
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delegate-attributes-of-processes-to-an-aggregation" title="Delegate attributes of processes to an aggregation" class="md-nav__link">
    Delegate attributes of processes to an aggregation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-delegations" title="Default delegations" class="md-nav__link">
    Default delegations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-attribute-value-for-specific-processes-of-an-aggregation" title="Set attribute value for specific processes of an aggregation" class="md-nav__link">
    Set attribute value for specific processes of an aggregation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-modules-of-an-aggregation" title="Define modules of an aggregation." class="md-nav__link">
    Define modules of an aggregation.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-an-aggregation-as-start-aggregation-for-a-pipeline" title="Set an aggregation as start aggregation for a pipeline" class="md-nav__link">
    Set an aggregation as start aggregation for a pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-dependency-of-aggregations-and-processes" title="The dependency of aggregations and processes" class="md-nav__link">
    The dependency of aggregations and processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copy-an-aggregation" title="Copy an aggregation" class="md-nav__link">
    Copy an aggregation
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../command-line-tool/" title="Command line tool" class="md-nav__link">
      Command line tool
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../change-log/" title="Change log" class="md-nav__link">
      Change log
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initialize-an-aggregation" title="Initialize an aggregation" class="md-nav__link">
    Initialize an aggregation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-a-process-on-the-run" title="Add a process on the run" class="md-nav__link">
    Add a process on the run
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delegate-attributes-of-processes-to-an-aggregation" title="Delegate attributes of processes to an aggregation" class="md-nav__link">
    Delegate attributes of processes to an aggregation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-delegations" title="Default delegations" class="md-nav__link">
    Default delegations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-attribute-value-for-specific-processes-of-an-aggregation" title="Set attribute value for specific processes of an aggregation" class="md-nav__link">
    Set attribute value for specific processes of an aggregation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-modules-of-an-aggregation" title="Define modules of an aggregation." class="md-nav__link">
    Define modules of an aggregation.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-an-aggregation-as-start-aggregation-for-a-pipeline" title="Set an aggregation as start aggregation for a pipeline" class="md-nav__link">
    Set an aggregation as start aggregation for a pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-dependency-of-aggregations-and-processes" title="The dependency of aggregations and processes" class="md-nav__link">
    The dependency of aggregations and processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copy-an-aggregation" title="Copy an aggregation" class="md-nav__link">
    Copy an aggregation
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Aggregations</h1>
                
                <p>Imagine that you have a set of processes predefined, and every time when you deal with similar problems (i.e. format a file and plot the data or some next generation sequencing data analysis), you will consistently use those processes, then you have to configure and call them every time. </p>
<p>Aggregations are designed for this kind of situations, you can just define an aggregations with those processes, and adjust the dependencies, input and arguments, you will be able to re-use the aggregation with very less configuration.</p>
<p>For example:
<div class="highlight"><pre><span></span><span class="n">pTrimmomaticPE</span><span class="o">.</span><span class="n">input</span>             <span class="o">=</span> <span class="o">&lt;</span><span class="nb">input</span> <span class="n">channel</span><span class="o">&gt;</span>
<span class="n">pAlignPEByBWA</span><span class="o">.</span><span class="n">depends</span>            <span class="o">=</span> <span class="n">pTrimmomaticPE</span>
<span class="n">pSortSam</span><span class="o">.</span><span class="n">depends</span>                 <span class="o">=</span> <span class="n">pAlignPEByBWA</span>
<span class="n">pMarkDuplicates</span><span class="o">.</span><span class="n">depends</span>          <span class="o">=</span> <span class="n">pSortSam</span>
<span class="n">pIndexBam</span><span class="o">.</span><span class="n">depends</span>                <span class="o">=</span> <span class="n">pMarkDuplicates</span>
<span class="n">pRealignerTargetCreator</span><span class="o">.</span><span class="n">depends</span>  <span class="o">=</span> <span class="n">pIndexBam</span>
<span class="n">pIndelRealigner</span><span class="o">.</span><span class="n">depends</span>          <span class="o">=</span> <span class="n">pIndexBam</span><span class="p">,</span> <span class="n">pRealignerTargetCreator</span>
<span class="n">pBaseRecalibrator</span><span class="o">.</span><span class="n">depends</span>        <span class="o">=</span> <span class="n">pIndelRealigner</span>
<span class="n">pPrintReads</span><span class="o">.</span><span class="n">depends</span>              <span class="o">=</span> <span class="n">pIndelRealigner</span><span class="p">,</span> <span class="n">pBaseRecalibrator</span>
<span class="n">pPrintReads</span><span class="o">.</span><span class="n">exportdir</span>            <span class="o">=</span> <span class="n">exdir</span>

<span class="n">pMarkDuplicates</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>   <span class="o">=</span> <span class="s2">&quot;/local2/tmp/&quot;</span>
<span class="n">pAlignPEByBWA</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span>           <span class="o">=</span> <span class="n">reffile</span>
<span class="n">pRealignerTargetCreator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span> <span class="o">=</span> <span class="n">reffile</span>
<span class="n">pRealignerTargetCreator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span><span class="o">=</span><span class="s1">&#39;/local2/tmp/&#39;</span>
<span class="n">pIndelRealigner</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span>         <span class="o">=</span> <span class="n">reffile</span>
<span class="n">pIndelRealigner</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>   <span class="o">=</span> <span class="s1">&#39;/local2/tmp/&#39;</span>
<span class="n">pBaseRecalibrator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span>       <span class="o">=</span> <span class="n">reffile</span>
<span class="n">pBaseRecalibrator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">knownSites</span>    <span class="o">=</span> <span class="n">dbsnp</span>
<span class="n">pBaseRecalibrator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span><span class="s1">&#39;/local2/tmp/&#39;</span>
<span class="n">pPrintReads</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span>             <span class="o">=</span> <span class="n">reffile</span>
<span class="n">pPrintReads</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span>              <span class="o">=</span> <span class="s1">&#39;/local2/tmp/&#39;</span>

<span class="n">PyPPL</span><span class="p">({</span>
    <span class="s1">&#39;proc&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;forks&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s1">&#39;runner&#39;</span><span class="p">:</span> <span class="s1">&#39;sge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sgeRunner&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;sge.q&#39;</span><span class="p">:</span> <span class="s1">&#39;lg-mem&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pTrimmomaticPE</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
This is a very commonly used Whole Genome Sequencing data cleanup pipeline from the raw reads according to the <a href="https://software.broadinstitute.org/gatk/best-practices/">GATK best practice</a>. And it will be used pretty much every time when the raw read files come. </p>
<p>With an aggregation defined, you don't need to configure and call those processes every time:
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">Aggr</span>
<span class="kn">from</span> <span class="nn">bioprocs</span> <span class="kn">import</span> <span class="n">params</span>
<span class="c1"># some paramters defined in params</span>
<span class="n">aFastqPE2Bam</span> <span class="o">=</span> <span class="n">Aggr</span> <span class="p">(</span>
    <span class="n">pTrimmomaticPE</span><span class="p">,</span>
    <span class="n">pAlignPEByBWA</span><span class="p">,</span>
    <span class="n">pSortSam</span><span class="p">,</span>
    <span class="n">pMarkDuplicates</span><span class="p">,</span>
    <span class="n">pIndexBam</span><span class="p">,</span>
    <span class="n">pRealignerTargetCreator</span><span class="p">,</span>
    <span class="n">pIndelRealigner</span><span class="p">,</span>
    <span class="n">pBaseRecalibrator</span><span class="p">,</span>
    <span class="n">pPrintReads</span>
<span class="p">)</span>
<span class="c1"># dependency adjustment</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pIndelRealigner</span><span class="o">.</span><span class="n">depends</span>   <span class="o">=</span> <span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pIndexBam</span><span class="p">,</span> <span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pRealignerTargetCreator</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pPrintReads</span><span class="o">.</span><span class="n">depends</span>       <span class="o">=</span> <span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pIndelRealigner</span><span class="p">,</span> <span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pBaseRecalibrator</span>
<span class="c1"># input adjustment</span>
<span class="c1"># args adjustment</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pMarkDuplicates</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>       <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pAlignPEByBWA</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span>               <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">hg19fa</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pRealignerTargetCreator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span>     <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">hg19fa</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pRealignerTargetCreator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span><span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pIndelRealigner</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span>             <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">hg19fa</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pIndelRealigner</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>       <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pBaseRecalibrator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span>           <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">hg19fa</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pBaseRecalibrator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">knownSites</span>        <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">dbsnp</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pBaseRecalibrator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>     <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pPrintReads</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span>                 <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">hg19fa</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pPrintReads</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>           <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">tmpdir</span>
</pre></div></p>
<p>Then every time you just need to call the aggregation:
<div class="highlight"><pre><span></span><span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">fromPairs</span> <span class="p">(</span> <span class="n">datadir</span> <span class="o">+</span> <span class="s1">&#39;/*.fastq.gz&#39;</span> <span class="p">)</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">exdir</span> <span class="o">=</span> <span class="n">exdir</span>
<span class="n">PyPPL</span><span class="p">({</span>
    <span class="s1">&#39;proc&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;sgeRunner&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;sge.q&#39;</span> <span class="p">:</span> <span class="s1">&#39;1-day&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">aFastqPE2Bam</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div></p>
<h2 id="initialize-an-aggregation">Initialize an aggregation</h2>
<p>Like previous example shows, you just need to give the constructor all the processes to construct an aggretation. However, there are several things need to be noticed:</p>
<ol>
<li>The dependencies are automatically constructed by the order of the processes. 
   <div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Aggr</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span>
<span class="c1"># The dependencies will be p1 -&gt; p2 -&gt; p3</span>
</pre></div></li>
<li>The starting and ending processes are defined as the first and last processes, respectively. If you need to modify the dependencies, keep that in mind whether the starting and ending processes are changed.
    <div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Aggr</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span>
<span class="c1"># a.starts == [p1]</span>
<span class="c1"># a.ends   == [p3]</span>
<span class="c1">#                                / p2</span>
<span class="c1"># change the dependencies to  p1      &gt;</span>
<span class="c1">#                                \ p3</span>
<span class="c1"># both p2, p3 depend on p1, and p3 depends on p2</span>
<span class="n">a</span><span class="o">.</span><span class="n">p3</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span>
<span class="c1"># but remember the ending processes are changed from [p3] to [p2, p3]</span>
<span class="n">a</span><span class="o">.</span><span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">]</span>
</pre></div>
    You can also specify the dependencies manually:
    <div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Aggr</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">depends</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">p2</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p1</span>
<span class="n">a</span><span class="o">.</span><span class="n">p3</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span>
<span class="n">a</span><span class="o">.</span><span class="n">starts</span> <span class="o">=</span> <span class="p">[</span><span class="n">p1</span><span class="p">]</span>
<span class="n">a</span><span class="o">.</span><span class="n">ends</span>   <span class="o">=</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">]</span>
</pre></div></li>
<li>If you have one process used twice in the aggregation, copy it with a different id:
   <div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Aggr</span><span class="p">(</span>
    <span class="n">p1</span><span class="p">,</span>
    <span class="n">p2</span><span class="p">,</span>
    <span class="n">p1</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;p1copy&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># then to access the 2nd p1: a.p1copy</span>
</pre></div></li>
<li>Each process is copied by aggregation, so the original one can still be used.</li>
<li>The tag of each process is regenerated by the id of the aggregation.</li>
</ol>
<h2 id="add-a-process-on-the-run">Add a process on the run</h2>
<p><code>aggr.addProc(p, where=None)</code>
You can add a process, and also define whether to put it in <code>starts</code>, <code>ends</code>, <code>both</code> or <code>None</code>.</p>
<h2 id="delegate-attributes-of-processes-to-an-aggregation">Delegate attributes of processes to an aggregation</h2>
<p>You can Delegate the attributes directly for a process to an aggregation:
<div class="highlight"><pre><span></span><span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">delegate</span><span class="p">(</span><span class="s1">&#39;args.reffile&#39;</span><span class="p">,</span> <span class="s1">&#39;pAlignPEByBWA&#39;</span><span class="p">)</span>
</pre></div>
Then when you want to set <code>args.reffile</code> for <code>pAlignPEByBWA</code>, you can just do:
<div class="highlight"><pre><span></span><span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">reffile</span> <span class="o">=</span> <span class="s1">&#39;/path/to/hg19.fa&#39;</span>
</pre></div>
You may use <code>starts/ends</code> represents the start/end processes.  </p>
<p>Delegate an attribute to multiple processes:
<div class="highlight"><pre><span></span><span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">delegate</span><span class="p">(</span><span class="s1">&#39;args.reffile&#39;</span><span class="p">,</span> <span class="s1">&#39;pAlignPEByBWA, pPrintReads&#39;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">delegate</span><span class="p">(</span><span class="s1">&#39;args.reffile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;pAlignPEByBWA&#39;</span><span class="p">,</span> <span class="s1">&#39;pPrintReads&#39;</span><span class="p">])</span>
<span class="c1"># or</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">delegate</span><span class="p">(</span><span class="s1">&#39;args.reffile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pAlignPEByBWA</span><span class="p">,</span> <span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pPrintReads</span><span class="p">])</span>
</pre></div></p>
<p>Delegate multiple attributes at one time:
<div class="highlight"><pre><span></span><span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">delegate</span><span class="p">(</span><span class="s1">&#39;args.reffile, args.tmpdir&#39;</span><span class="p">,</span> <span class="s1">&#39;pAlignPEByBWA, pPrintReads&#39;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">delegate</span><span class="p">([</span><span class="s1">&#39;args.reffile&#39;</span><span class="p">,</span> <span class="s1">&#39;args.tmpdir&#39;</span><span class="p">],</span> <span class="s1">&#39;pAlignPEByBWA, pPrintReads&#39;</span><span class="p">)</span>
</pre></div></p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Undelegated attributes will be delegated to all processes. But remember if an attribute has been set before, say <code>p.runner = 'local'</code> then, <code>aggr.runner</code> will not overwrite it if <code>runner</code> is not delegated. If it is, then it'll be overwritten.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For attributes that have sub-attributes (i.e. <code>p.args.params.inopts.cnames</code>), you may just delegate the first parts, then the full assignment of the attribute will still follow the delegation. For example:<br />
<div class="highlight"><pre><span></span><span class="n">aggr</span><span class="o">.</span><span class="n">delegate</span><span class="p">(</span><span class="s1">&#39;args.params&#39;</span><span class="p">,</span> <span class="s1">&#39;p1,p2&#39;</span><span class="p">)</span>
<span class="n">aggr</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">inopts</span><span class="o">.</span><span class="n">cnames</span> <span class="o">=</span> <span class="bp">True</span> <span class="c1"># only affects p1, p2</span>
</pre></div>
Keep in mind that shorter delegations always come first. In the above case, if we have another delegation: <code>aggr.delegate('args.params.inopts', 'p3')</code>, then the assignment will still affect <code>p1, p2</code> (the first delegation) and <code>p3</code> (the second delegation).</p>
</div>
<h2 id="default-delegations">Default delegations</h2>
<p>By default, <code>input/depends</code> are delegated for start processes, and <code>exdir/exhow/exow/expart</code> for end processes. Importantly, as <code>aggr.starts</code> is a list, the values for <code>input/depends</code> must be a list as well, with elements corresponing to each start process. 
Besides, we have two special attributes for aggregations: <code>input2</code> and <code>depends2</code>. Unlike <code>input</code> and <code>depends</code>, <code>input2</code> and <code>depends2</code> try to pass everything it gets to each process, instead of passing corresponind element to each process. For example:
<div class="highlight"><pre><span></span><span class="c1"># aggr.starts = [aggr.p1, aggr.p2]</span>
<span class="n">aggr</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]]</span>
<span class="c1"># then:</span>
<span class="c1"># aggr.p1.config[&#39;input&#39;] == [&#39;a&#39;]</span>
<span class="c1"># aggr.p2.config[&#39;input&#39;] == [&#39;b&#39;]</span>

<span class="n">aggr</span><span class="o">.</span><span class="n">input2</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]]</span>
<span class="c1"># then:</span>
<span class="c1"># aggr.p1.config[&#39;input&#39;] == [[&#39;a&#39;], [&#39;b&#39;]]</span>
<span class="c1"># aggr.p2.config[&#39;input&#39;] == [[&#39;a&#39;], [&#39;b&#39;]]</span>
</pre></div></p>
<h2 id="set-attribute-value-for-specific-processes-of-an-aggregation">Set attribute value for specific processes of an aggregation</h2>
<p>There are several ways to do that:
<div class="highlight"><pre><span></span><span class="c1"># refer to the process directly</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pPrintReads</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>
<span class="n">aFastqPE2Bam</span><span class="o">.</span><span class="n">pPrintReads</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="c1"># refer to the index of the process</span>
<span class="n">aFastqPE2Bam</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>
<span class="n">aFastqPE2Bam</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="c1"># refer to the name of the process</span>
<span class="n">aFastqPE2Bam</span><span class="p">[</span><span class="s1">&#39;pPrintReads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>
<span class="n">aFastqPE2Bam</span><span class="p">[</span><span class="s1">&#39;pPrintReads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>

<span class="c1"># for multiple processes</span>
<span class="n">aFastqPE2Bam</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>
<span class="n">aFastqPE2Bam</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>
<span class="n">aFastqPE2Bam</span><span class="p">[</span><span class="s1">&#39;aFastqPE2Bam&#39;</span><span class="p">,</span> <span class="s1">&#39;pPrintReads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>
<span class="n">aFastqPE2Bam</span><span class="p">[</span><span class="s1">&#39;aFastqPE2Bam, pPrintReads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>

<span class="c1"># or you may use starts/ends to refer to the start/end processes</span>
<span class="c1"># has to be done after aggr.starts/aggr.ends assigned </span>
<span class="c1"># or initialized with depends = True</span>
<span class="n">aFastqPE2Bam</span><span class="p">[</span><span class="s1">&#39;starts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>
<span class="n">aFastqPE2Bam</span><span class="p">[</span><span class="s1">&#39;ends&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span>
</pre></div></p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If an attribute is delegated for other processes, you can still set the value of it by the above methods.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When use <code>__getitem__</code> to select processes from aggregations, only the index or the id will return the processes itself (instance of <code>Proc</code>), otherwise it will return an instance <code>_Proxy</code>, which is proxy used to pass attribute values to a set of processes.<br />
So pay attention to it, because we can do <code>aggr['pXXX1, pXXX2'].depends = "pXXX3, pXXX4"</code> to <code>aggr.pXXX3</code> and <code>aggr.pXXX4</code> as the dependent of <code>aggr.pXXX1</code> and <code>aggr.pXXX2</code> respectively, but if you do <code>aggr['pXXX1'] = 'pXXX3'</code> will raise an error. Because <code>_Proxy</code> helps the aggregation to select the processes from itselt, but a <code>Proc</code> instance doesn't know how to.<br />
You may turn it into <code>_Proxy</code> from <code>Proc</code> instance simply by add a comma to the selector:
<div class="highlight"><pre><span></span><span class="nb">isinstance</span><span class="p">(</span><span class="n">aggr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Proc</span><span class="p">)</span>
<span class="nb">isinstance</span><span class="p">(</span><span class="n">aggr</span><span class="p">[</span><span class="mi">0</span><span class="p">,],</span> <span class="n">_Proxy</span><span class="p">)</span>
<span class="nb">isinstance</span><span class="p">(</span><span class="n">aggr</span><span class="p">[</span><span class="s1">&#39;pXXX1&#39;</span><span class="p">],</span> <span class="n">Proc</span><span class="p">)</span>
<span class="nb">isinstance</span><span class="p">(</span><span class="n">aggr</span><span class="p">[</span><span class="s1">&#39;pXXX1,&#39;</span><span class="p">],</span> <span class="n">_Proxy</span><span class="p">)</span> <span class="c1"># or</span>
<span class="nb">isinstance</span><span class="p">(</span><span class="n">aggr</span><span class="p">[</span><span class="s1">&#39;pXXX1&#39;</span><span class="p">,],</span> <span class="n">_Proxy</span><span class="p">)</span> 
</pre></div></p>
</div>
<h2 id="define-modules-of-an-aggregation">Define modules of an aggregation.</h2>
<p>We can define some modules for an aggregation, later on we can switch them on or off.<br />
To define a module, you can simply do:
<div class="highlight"><pre><span></span><span class="n">aggr</span><span class="o">.</span><span class="n">module</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">starts</span> <span class="o">=</span> <span class="s1">&#39;pStart&#39;</span><span class="p">,</span> <span class="n">ends</span> <span class="o">=</span> <span class="s1">&#39;pEnd&#39;</span><span class="p">,</span> <span class="n">depends</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pEnd&#39;</span><span class="p">:</span> <span class="s1">&#39;pStart&#39;</span><span class="p">})</span>
</pre></div>
Later on, when we switch this module on: <code>aggr.on('name')</code>, then <code>aggr.pStart</code> will be added to <code>aggr.starts</code>, <code>aggr.pEnds</code> will be added to <code>aggr.ends</code>, and <code>aggr.pEnd</code> will be set to depend on <code>aggr.pStart</code>. When we switch it off, then <code>aggr.pStart</code> will be removed from <code>aggr.starts</code>, <code>aggr.pEnds</code> will be removed from <code>aggr.ends</code>, and <code>aggr.pStart</code> will be removed from <code>aggr.pStart</code>'s dependents.<br />
If you want to keep some processes from being removed when the module is switched off, as they are used by other modules, you may do: 
<div class="highlight"><pre><span></span><span class="n">aggr</span><span class="o">.</span><span class="n">module</span><span class="p">(</span>
    <span class="s1">&#39;name&#39;</span><span class="p">,</span> 
    <span class="n">starts</span>      <span class="o">=</span> <span class="s1">&#39;pStart&#39;</span><span class="p">,</span>
    <span class="n">ends</span>        <span class="o">=</span> <span class="s1">&#39;pEnd&#39;</span><span class="p">,</span>
    <span class="n">depends</span>     <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pEnd&#39;</span><span class="p">:</span> <span class="s1">&#39;pStart&#39;</span><span class="p">},</span>
    <span class="n">ends_shared</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pEnd&#39;</span><span class="p">:</span> <span class="s1">&#39;othermod&#39;</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
Then when the module is switched off, <code>aggr.pEnd</code> will be kept.</p>
<p>If you have something else to be done when a module is switched on/off, you may use <code>moduleFunc</code> to define them:
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">name_on</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">addStart</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pStart</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">pEnd</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">pStart</span>
    <span class="n">a</span><span class="o">.</span><span class="n">addEnd</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pEnd</span><span class="p">)</span>
    <span class="c1"># more stuff go here</span>
<span class="k">def</span> <span class="nf">name_off</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">delStart</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pStart</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">pEnd</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">a</span><span class="o">.</span><span class="n">delEnd</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pEnd</span><span class="p">)</span>
    <span class="c1"># more stuff go here</span>
<span class="n">aggr</span><span class="o">.</span><span class="n">moduleFunc</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">off</span><span class="p">)</span>
</pre></div></p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You may use <code>aggr.on()</code> to switch all modules on and <code>aggr.off()</code> to switch all modules off.</p>
</div>
<h2 id="set-an-aggregation-as-start-aggregation-for-a-pipeline">Set an aggregation as start aggregation for a pipeline</h2>
<p>You can do it just like setting a process as the starting process of pipeline (see <a href="./configure-a-pipeline/#starting-processes">here</a>). Actually the starting processes in the aggregation (<code>aggr.starts</code>) will be set as the starting processes of the pipeline.</p>
<h2 id="the-dependency-of-aggregations-and-processes">The dependency of aggregations and processes</h2>
<p>An aggregation can depend on aggregations and/or processes, you just treat the aggregations as processes. A process can also depend on aggregations and/or processes. </p>
<table>
<thead>
<tr>
<th>What am I?</th>
<th>Whom I am depending on?</th>
<th>Real relations</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Aggr</code> (<code>a1</code>)</td>
<td><code>Aggr</code> (<code>a2</code>)</td>
<td><code>a1.starts</code> depends on <code>a2.ends</code></td>
</tr>
<tr>
<td><code>Proc</code> (<code>p</code>)</td>
<td><code>Aggr</code> (<code>a</code>)</td>
<td><code>p</code> depends on <code>a.ends</code></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You have to specify <code>depends</code> for start processes of an aggregation.</p>
</div>
<h2 id="copy-an-aggregation">Copy an aggregation</h2>
<p><code>Aggr.copy(tag = 'notag', depends = True, id = None, delegates = True, modules = True)</code>
You may copy an aggregation, all the processes in the aggregation will be copied, and the dependencies will be switched to the corresponding copied processes, as well as the starting and ending processes, if <code>copyDeps == True</code>. </p>
<p>You can keep the ids of processes unchanged but give a new tag and also give the aggregation an new id instead of the variable name:
<div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Aggr</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span>
<span class="c1"># access the processes:</span>
<span class="c1"># a.p1, a.p2, a.p3</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="s1">&#39;copied&#39;</span><span class="p">)</span>
<span class="c1"># a2.procs == [</span>
<span class="c1"># &lt;proc with id &quot;p1&quot; and tag &quot;copied&quot;&gt;,</span>
<span class="c1"># &lt;proc with id &quot;p2&quot; and tag &quot;copied&quot;&gt;,</span>
<span class="c1"># &lt;proc with id &quot;p3&quot; and tag &quot;copied&quot;&gt;,</span>
<span class="c1"># ]</span>
<span class="c1"># a2.id == &#39;a2&#39;</span>
<span class="c1"># to access the processes:</span>
<span class="c1"># a2.p1, a2.p2, a2.p3</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="s1">&#39;copied&#39;</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;newAggr&#39;</span><span class="p">)</span>
<span class="c1"># a2.id == &#39;newAggr&#39;</span>
</pre></div></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../command-line-argument-parser/" title="Command line argument parser" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Command line argument parser
              </span>
            </div>
          </a>
        
        
          <a href="../command-line-tool/" title="Command line tool" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Command line tool
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b41f3d20.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>