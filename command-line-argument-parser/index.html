<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Command line argument parser - PyPPL</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Command line argument parser";
    var mkdocs_page_input_path = "command-line-argument-parser.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> PyPPL</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../basic-concepts-and-directory-structure/">Basics and folder structure</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../placeholders/">Templating</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../channels/">Channels</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../specify-input-and-output-of-a-process/">Input and output of a process</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../write-your-script/">The heart: script</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../export-output-files/">Output file exporting</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../caching/">Caching and resuming processes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../runners/">Runners and running profiles</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../error-handling/">Error handling of processes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../set-other-properties-of-a-process/">Other attributes of a process</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../configure-your-logs/">Log configuration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../draw-flowchart-of-a-pipeline/">Pipeline flowchart</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../configure-a-pipeline/">Pipeline configuration</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Command line argument parser</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#command-line-argument-parser">Command line argument parser</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#add-an-option">Add an option</a></li>
        
            <li><a class="toctree-l3" href="#set-attributes-of-an-option">Set attributes of an option</a></li>
        
            <li><a class="toctree-l3" href="#load-params-from-a-dict">Load params from a dict</a></li>
        
            <li><a class="toctree-l3" href="#load-params-from-a-configuration-file">Load params from a configuration file</a></li>
        
            <li><a class="toctree-l3" href="#preseved-option-names">Preseved option names</a></li>
        
            <li><a class="toctree-l3" href="#set-other-attributes-of-params">Set other attributes of params</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../aggregations/">Aggregations</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../command-line-tool/">Command line tool</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../api/">API</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../faq/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../change-log/">Change log</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">PyPPL</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Command line argument parser</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="command-line-argument-parser">Command line argument parser</h1>
<!-- toc -->

<p>This module is just for your convenience. You are free to use Python's built-in <code>argparse</code> module or just use <code>sys.argv</code>.</p>
<p>To start with, just import it from <code>PyPPL</code>:
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyppl</span> <span class="kn">import</span> <span class="n">params</span>
</pre></div></p>
<h2 id="add-an-option">Add an option</h2>
<p><div class="highlight"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
<span class="c1"># or</span>
<span class="c1"># params.opt.setValue(&#39;a&#39;)</span>
<span class="n">params</span><span class="o">.</span><span class="n">opt2</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setRequired</span><span class="p">()</span>

<span class="c1"># then don&#39;t forget to parse the command line arguments:</span>
<span class="n">params</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
</pre></div>
Then <code>python pipeline.py -opt b -opt2 1 2 3</code> will overwrite the value.<br />
<code>list</code> option can also be specified as <code>-opt2 1 -opt2 2 -opt2 3</code>
To use the value:
<div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="s1">&#39;2&#39;</span>
<span class="c1"># var is &#39;b2&#39;</span>
<span class="n">var2</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">opt2</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="c1"># var2 is [1, 2, 3, 4]</span>
</pre></div></p>
<p>If you feel annoying using <code>params.xxx.value</code> to have the value of the option, you can convert the <code>params</code> object to a <code>Box</code> object (inherited from <code>OrderedDict</code>):
<div class="highlight"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">asDict</span><span class="p">()</span>
<span class="c1"># or just</span>
<span class="c1"># ps = params.parse()</span>
</pre></div>
Then you can use <code>params.xxx</code> to get the value directly:
<div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">opt</span> <span class="o">+</span> <span class="s1">&#39;2&#39;</span>
<span class="n">var2</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">opt2</span> <span class="o">+</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div></p>
<h2 id="set-attributes-of-an-option">Set attributes of an option</h2>
<p>An option has server properties:
- <code>desc</code>: The description of the option, shows in the help page. Default: <code>[]</code>
- <code>required</code>: Whether the option is required. Default: <code>False</code>
- <code>show</code>: Whether this option should be shown in the help page. Default: <code>True</code>
- <code>type</code>: The type of the option value. Default: <code>str</code>
- <code>name</code>: The name of the option, then in command line, <code>-&lt;name&gt;</code> refers to the option.
- <code>value</code>: The default value of the option.</p>
<p>You can either set the value of an option by 
<div class="highlight"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">required</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
or
<div class="highlight"><pre><span></span><span class="n">params</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">setRequired</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="c1"># params.opt.setDesc(&#39;Desctipion&#39;)</span>
<span class="c1"># params.opt.setShow(False)</span>
<span class="c1"># params.opt.setType(list)</span>
<span class="c1"># params.opt.setName(&#39;opt1&#39;)</span>
<span class="c1"># params.opt.setValue([1,2,3])</span>
<span class="c1"># or they can be chained:</span>
<span class="c1"># params.opt.setDesc(&#39;Desctipion&#39;) \</span>
<span class="c1">#           .setShow(False)        \</span>
<span class="c1">#           .setType(list)         \</span>
<span class="c1">#           .setName(&#39;opt1&#39;)       \</span>
<span class="c1">#           .setValue([1,2,3])</span>
</pre></div></p>
<h3 id="about-type">About <code>type</code></h3>
<h4 id="declear-the-type-of-an-option">Declear the type of an option</h4>
<p>You can use either the type itself or the type name:<br />
<code>params.opt.type = int</code> or <code>params.opt.type = 'int'</code></p>
<h4 id="infer-type-when-option-initialized">Infer type when option initialized</h4>
<p>When you initialize an option:
<div class="highlight"><pre><span></span><span class="c1"># with nothing specified</span>
<span class="n">params</span><span class="o">.</span><span class="n">opt</span>
<span class="c1"># with a default value</span>
<span class="n">params</span><span class="o">.</span><span class="n">opt</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
The type will be inferred from the value. In the first case, the type is <code>None</code>, will in the second, it's <code>'int'</code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Let initialize an option first: <code>params.opt</code>, then when the value is set explictly:<br />
<code>params.opt.value = "a"</code><br />
Or when the value replaced (set value after initialization):<br />
<code>params.opt = "a"</code><br />
The type will not be changed (it's <code>None</code> in this case).</p>
</div>
<h4 id="allowed-types">Allowed types</h4>
<p>Literally, allowed types are <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code> and <code>list</code>. But we allow subtypes (types of elements) for <code>list</code>. By default, the value of <code>list</code> elements will be recognized automatically. For example, <code>'1'</code> will be recognized as an integer <code>1</code>, and <code>"True"</code> will be recognized as bool value <code>True</code>. You can avoid this by specified the subtypes explictly: <code>params.opt.type = 'list:str'</code>, then <code>'1'</code> will be kept as <code>'1'</code> rather than <code>1</code>, and <code>"True"</code> will be <code>"True"</code> instead of <code>True</code>.</p>
<p>You can use shortcuts for the types:
<div class="highlight"><pre><span></span>i     -&gt; &#39;int&#39;
f     -&gt; &#39;float&#39;
b     -&gt; &#39;bool&#39;
s     -&gt; &#39;str&#39;
l     -&gt; &#39;list&#39;
array -&gt; &#39;list&#39;
</pre></div>
For subtypes, you can also do <code>params.opt.type = 'l:s'</code> indicating <code>list:str</code>. Or you can even mix them: <code>params.opt.type = 'l:str'</code> or <code>params.opt.type = 'list:s'</code></p>
<h4 id="overwrite-the-type-from-command-line">Overwrite the type from command line</h4>
<p>Even though we may declear the type of an option by <code>params.opt.type = 'list:str'</code>, the users are able to overwrite it by pass the type through command argument:<br />
<code>&gt; program -opt:list:int 1 2 3</code><br />
Then we will get: <code>params.opt.value == [1,2,3]</code> instead of <code>params.opt.value == ['1', '2', '3']</code> when we do:<br />
<code>&gt; program -opt 1 2 3</code><br />
Flexibly, we can have mixed types of elements in a list option:<br />
<code>&gt; program -opt:list:bool 1 -opt:list:int 2 -opt:list:str 3</code><br />
We will get: <code>params.opt.value == [True, 2, '3']</code></p>
<h2 id="load-params-from-a-dict">Load params from a dict</h2>
<p>You can define a <code>dict</code>, and then load it to <code>params</code>:
<div class="highlight"><pre><span></span><span class="n">d2load</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;p1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;p1.required&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="s1">&#39;p2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;p2.show&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="s1">&#39;p3&#39;</span><span class="p">:</span> <span class="mf">2.3</span><span class="p">,</span>
    <span class="s1">&#39;p3.desc&#39;</span><span class="p">:</span> <span class="s1">&#39;The p3 params&#39;</span><span class="p">,</span>
    <span class="s1">&#39;p3.required&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="s1">&#39;p3.show&#39;</span><span class="p">:</span> <span class="bp">True</span>
<span class="p">}</span>
<span class="n">params</span><span class="o">.</span><span class="n">loadDict</span> <span class="p">(</span><span class="n">d2load</span><span class="p">)</span>
<span class="c1"># params.p1.value    == 1</span>
<span class="c1"># params.p1.required == True</span>
<span class="c1"># params.p1.show     == False</span>
<span class="c1"># params.p1.type     == int</span>
<span class="c1"># params.p2.value    == [1,2,3]</span>
<span class="c1"># params.p2.required == False</span>
<span class="c1"># params.p2.show     == True</span>
<span class="c1"># params.p2.type     == list</span>
<span class="c1"># params.p3.value    == 2.3</span>
<span class="c1"># params.p3.required == True</span>
<span class="c1"># params.p3.show     == False</span>
<span class="c1"># params.p3.type     == float</span>
</pre></div>
Note that by default, the options from the <code>dict</code> will be hidden from the help page. If you want to show some of them, just set <code>p2.show = True</code>, or you want to show them all: <code>params.loadDict(d2load, show = True)</code></p>
<h2 id="load-params-from-a-configuration-file">Load params from a configuration file</h2>
<p>If the configuration file has a name ending with '.json', then <code>json.load</code> will be used to load the file into a <code>dict</code>, and <code>params.loadDict</code> will be used to load it to <code>params</code></p>
<p>Else python's <code>ConfigParse</code> will be used. All params in the configuration file should be under one section with whatever name:
<div class="highlight"><pre><span></span><span class="k">[Config]</span>
<span class="na">p1: 1</span>
<span class="na">p1.required: True</span>
<span class="na">p2: [1,2,3]</span>
<span class="na">p2.show: True</span>
<span class="na">p3: 2.3</span>
<span class="na">p3.desc</span> <span class="o">=</span> <span class="s">&#39;The p3 params&#39;</span>
<span class="na">p3.required: True</span>
<span class="na">p3.show: True</span>
</pre></div></p>
<p>Similarly, you can set the default value for <code>show</code> property by: <code>params.loadCfgfile("params.config", show=True)</code></p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><code>params</code> is a singleton of <code>Parameters</code>. It's a combination of configuration and command line arguments. So you are able to load the configurations from files, which will be used as default values, before you parse the command line arguments. You are also able to choose some of the options for the users to pass value to, and some hidden from the users.</p>
</div>
<h2 id="preseved-option-names">Preseved option names</h2>
<p>We have a certain convention of the option names used with <code>params</code>:
- Make sure it's only composed of alphabetics, underscores and hyphens.
- Make sure it starts with alphabetics.
- Make sure it's not one of these words (<code>help</code>, <code>loadDict</code>, <code>loadFile</code> and <code>asDict</code>)</p>
<h2 id="set-other-attributes-of-params">Set other attributes of params</h2>
<h3 id="show-the-usagesexampledescription-of-the-program">Show the usages/example/description of the program</h3>
<p><code>params('usage', ["{prog} -h", "{prog} -infile &lt;infile&gt; [options]"])</code><br />
<code>params('example', ["{prog} -h", "{prog} -infile path/to/infile -out /path/to/outfile"])</code><br />
<code>params('desc', ["This program does this.", "This program also does that."])</code><br />
Multiple lines can also be passed as a string with <code>"\n"</code>:<br />
<code>params('desc', ["This program does this.\nThis program also does that."])</code></p>
<h3 id="set-the-prefix-of-option-names">Set the prefix of option names</h3>
<p>By default, the option names are recognized from the command line if they follow the convention and start with <code>-</code>. You may change it, let's say you want the option names to start with <code>--</code>:<br />
<code>params('prefix', '--')</code><br />
The only <code>prog --opt 1</code> will be parsed, instead of <code>prog -opt 1</code> to get the value by <code>params.opt.value</code>  </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You cannot use an empty prefix</p>
</div>
<h3 id="set-the-default-help-options">Set the default help options</h3>
<p>By default, the help options are <code>['-h', '--help', '-H', '-?', '']</code>. The empty string (<code>''</code>) enables the program to print the help page without arguments be passed from the command line. If you don't want it, you can remove it from the default help options:<br />
<code>params('hopts', '-h, --help, -H, -?')</code> or<br />
<code>params('hopts', ['-h', '--help', '-H', '-?'])</code><br />
Or you can just simply remove some of them by:<br />
<code>params('hopts', ['-H', '-?', ''], excl = True)</code><br />
Then you will only have <code>['-h', '--help']</code></p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>These statements can also be chained:<br />
<code>params('usage', ["{prog} -h", "{prog} -infile &lt;infile&gt; [options]"])('prefix', '--')('hopts', ['-H', '-?', ''], excl = True)</code></p>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../aggregations/" class="btn btn-neutral float-right" title="Aggregations">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../configure-a-pipeline/" class="btn btn-neutral" title="Pipeline configuration"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../configure-a-pipeline/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../aggregations/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
