



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Other attributes of a process - PyPPL</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.572ca0f0.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#set-arguments-of-a-process-pxxxargs" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="PyPPL" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                PyPPL
              </span>
              <span class="md-header-nav__topic">
                Other attributes of a process
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="PyPPL" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    PyPPL
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../basic-concepts-and-directory-structure/" title="Basics and folder structure" class="md-nav__link">
      Basics and folder structure
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../placeholders/" title="Templating" class="md-nav__link">
      Templating
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../channels/" title="Channels" class="md-nav__link">
      Channels
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../specify-input-and-output-of-a-process/" title="Input and output of a process" class="md-nav__link">
      Input and output of a process
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../write-your-script/" title="The heart: script" class="md-nav__link">
      The heart: script
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../export-output-files/" title="Output file exporting" class="md-nav__link">
      Output file exporting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../caching/" title="Caching and resuming processes" class="md-nav__link">
      Caching and resuming processes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../runners/" title="Runners and running profiles" class="md-nav__link">
      Runners and running profiles
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../error-handling/" title="Error handling of processes" class="md-nav__link">
      Error handling of processes
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Other attributes of a process
      </label>
    
    <a href="./" title="Other attributes of a process" class="md-nav__link md-nav__link--active">
      Other attributes of a process
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#set-arguments-of-a-process-pxxxargs" title="Set arguments of a process pXXX.args" class="md-nav__link">
    Set arguments of a process pXXX.args
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-the-valid-returnexit-codes-pxxxrc" title="Set the valid return/exit codes pXXX.rc" class="md-nav__link">
    Set the valid return/exit codes pXXX.rc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-the-processes-current-process-depends-on-pxxxdepends" title="Set the processes current process depends on pXXX.depends" class="md-nav__link">
    Set the processes current process depends on pXXX.depends
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-callback-to-modify-the-process-pxxxcallback" title="Use callback to modify the process pXXX.callback" class="md-nav__link">
    Use callback to modify the process pXXX.callback
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-callfront-to-modify-the-process-pxxxcallfront" title="Use callfront to modify the process pXXX.callfront" class="md-nav__link">
    Use callfront to modify the process pXXX.callfront
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configure-your-logs/" title="Log configuration" class="md-nav__link">
      Log configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../draw-flowchart-of-a-pipeline/" title="Pipeline flowchart" class="md-nav__link">
      Pipeline flowchart
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configure-a-pipeline/" title="Pipeline configuration" class="md-nav__link">
      Pipeline configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../command-line-argument-parser/" title="Command line argument parser" class="md-nav__link">
      Command line argument parser
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../aggregations/" title="Aggregations" class="md-nav__link">
      Aggregations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../command-line-tool/" title="Command line tool" class="md-nav__link">
      Command line tool
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../change-log/" title="Change log" class="md-nav__link">
      Change log
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#set-arguments-of-a-process-pxxxargs" title="Set arguments of a process pXXX.args" class="md-nav__link">
    Set arguments of a process pXXX.args
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-the-valid-returnexit-codes-pxxxrc" title="Set the valid return/exit codes pXXX.rc" class="md-nav__link">
    Set the valid return/exit codes pXXX.rc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-the-processes-current-process-depends-on-pxxxdepends" title="Set the processes current process depends on pXXX.depends" class="md-nav__link">
    Set the processes current process depends on pXXX.depends
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-callback-to-modify-the-process-pxxxcallback" title="Use callback to modify the process pXXX.callback" class="md-nav__link">
    Use callback to modify the process pXXX.callback
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-callfront-to-modify-the-process-pxxxcallfront" title="Use callfront to modify the process pXXX.callfront" class="md-nav__link">
    Use callfront to modify the process pXXX.callfront
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Other attributes of a process</h1>
                
                <p>Currently we introduced in previous chapters a set of attributes of a process and we will introduce the rest of them in this chapter:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Meaning</th>
<th>Possibile values/types</th>
<th>Default value</th>
<th>Where it's first mentioned</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>The id of the process</td>
<td><code>str</code></td>
<td><code>&lt;the variable name&gt;</code></td>
<td><a href="./placeholders/#proc-property-placeholders">Link</a></td>
</tr>
<tr>
<td><code>tag</code></td>
<td>The tag of the process, makes it possible to have two processes with the same <code>id</code> but different <code>tag</code>.</td>
<td><code>str</code></td>
<td><code>"notag"</code></td>
<td><a href="./placeholders/#proc-property-placeholders">Link</a></td>
</tr>
<tr>
<td><code>desc</code></td>
<td>The description of the process.</td>
<td><code>str</code></td>
<td><code>"No description"</code></td>
<td></td>
</tr>
<tr>
<td><code>echo</code></td>
<td>Whether to print out the <code>stdout</code> and <code>stderr</code></td>
<td><code>bool</code>/<code>dict</code></td>
<td><code>False</code></td>
<td><a href="./placeholders/#proc-property-placeholders">Link</a></td>
</tr>
<tr>
<td><code>input</code></td>
<td>The input of the process</td>
<td><code>dict</code>/<code>list</code>/<code>str</code></td>
<td></td>
<td><a href="./specify-input-and-output-of-a-process/#specify-input-of-a-process">Link</a></td>
</tr>
<tr>
<td><code>output</code></td>
<td>The output of the process</td>
<td><code>list</code>/<code>str</code>/<code>OrderedDict</code></td>
<td></td>
<td><a href="./specify-input-and-output-of-a-process/#specify-output-of-a-process">Link</a></td>
</tr>
<tr>
<td><code>script</code></td>
<td>The script of the process</td>
<td><code>str</code></td>
<td></td>
<td><a href="./write-your-script/">Link</a></td>
</tr>
<tr>
<td><code>lang</code></td>
<td>The language for the script</td>
<td><code>str</code></td>
<td><code>"bash"</code></td>
<td><a href="./write-your-script/">Link</a></td>
</tr>
<tr>
<td><code>exdir</code></td>
<td>The export directory</td>
<td><code>str</code></td>
<td></td>
<td><a href="./export-output-files/">Link</a></td>
</tr>
<tr>
<td><code>exhow</code></td>
<td>How to export</td>
<td><code>"move"</code>, <code>"copy"</code>, <code>"symlink"</code>, <code>"gzip"</code></td>
<td><code>"move"</code></td>
<td><a href="./export-output-files/">Link</a></td>
</tr>
<tr>
<td><code>exow</code></td>
<td>Whether to overwrite existing files when export</td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td><a href="./export-output-files/">Link</a></td>
</tr>
<tr>
<td><code>cache</code></td>
<td>Whether to cache the process</td>
<td><code>True</code>, <code>False</code>, <code>"export"</code></td>
<td><code>True</code></td>
<td><a href="./caching/">Link</a></td>
</tr>
<tr>
<td><code>runner</code></td>
<td>Which runner to use</td>
<td><code>str</code></td>
<td><code>"local"</code></td>
<td><a href="./runners/">Link</a></td>
</tr>
<tr>
<td><code>ppldir</code></td>
<td>The directory to store <code>&lt;workdir&gt;s</code> for all processes in this pipeline</td>
<td><code>str</code></td>
<td><code>"./workdir"</code></td>
<td><a href="./basic-concepts-and-directory-structure/#folder-structure">Link</a></td>
</tr>
<tr>
<td><code>workdir</code></td>
<td>The work directory of the process</td>
<td><code>str</code></td>
<td><code>"&lt;id&gt;.&lt;tag&gt;.&lt;uid&gt;"</code></td>
<td><a href="./basic-concepts-and-directory-structure/#folder-structure">Link</a></td>
</tr>
<tr>
<td><code>expart</code></td>
<td>Partial export</td>
<td><code>str</code>/<code>list</code></td>
<td></td>
<td><a href="./export-output-files/">Link</a></td>
</tr>
<tr>
<td><code>template</code></td>
<td>The name of the template engine</td>
<td><code>str</code></td>
<td><code>PyPPL</code></td>
<td><a href="./placeholders/#proc-property-placeholders">Link</a></td>
</tr>
<tr>
<td><code>envs</code></td>
<td>Environments for the template engine</td>
<td><code>dict</code></td>
<td></td>
<td><a href="./placeholders/#proc-property-placeholders">Link</a></td>
</tr>
<tr>
<td><code>acache</code></td>
<td>Whether do cleanup (output checking/exporting) if a job was cached.</td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td><a href="./export-output-files/#control-of-export-of-cached-jobs">Link</a></td>
</tr>
<tr>
<td><code>dirsig</code></td>
<td>Get the modified time for directory recursively (taking into account the dirs and files in it) for cache checking</td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td><a href="./caching/#calculating-signatures-for-caching">Link</a></td>
</tr>
<tr>
<td><code>errhow</code></td>
<td>What's next if jobs fail</td>
<td><code>"terminate"</code>, <code>"retry"</code>, <code>"ignore"</code></td>
<td><code>"terminate"</code></td>
<td><a href="./error-handling/">Link</a></td>
</tr>
<tr>
<td><code>errntry</code></td>
<td>If <code>errhow</code> is <code>"retry"</code>, how many time to re-try?</td>
<td><code>int</code></td>
<td>3</td>
<td><a href="./error-handling/">Link</a></td>
</tr>
<tr>
<td><code>expect</code></td>
<td>A command to check whether expected results generated</td>
<td><code>str</code></td>
<td></td>
<td><a href="./error-handling/">Link</a></td>
</tr>
<tr>
<td><code>nthread</code></td>
<td>Number of theads used for job construction and submission</td>
<td><code>int</code></td>
<td><code>min(int(cpu_count() / 2), 16)</code></td>
<td>-</td>
</tr>
<tr>
<td><code>args</code></td>
<td>The arguments for the process</td>
<td><code>dict</code></td>
<td><code>{}</code></td>
<td>This chapter</td>
</tr>
<tr>
<td><code>rc</code></td>
<td>Valid return codes</td>
<td><code>str</code>/<code>list</code>/<code>int</code></td>
<td><code>0</code></td>
<td>This chapter</td>
</tr>
<tr>
<td><code>beforeCmd</code></td>
<td>The command to run before jobs run</td>
<td><code>str</code></td>
<td></td>
<td>This chapter</td>
</tr>
<tr>
<td><code>afterCmd</code></td>
<td>The command to run after jobs finish</td>
<td><code>str</code></td>
<td></td>
<td>This chapter</td>
</tr>
<tr>
<td><code>depends</code></td>
<td>The processes the process depends on</td>
<td><code>proc</code>/<code>list</code></td>
<td></td>
<td>This chapter</td>
</tr>
<tr>
<td><code>callback</code></td>
<td>The callback, called after the process finishes</td>
<td><code>callable</code></td>
<td></td>
<td>This chapter</td>
</tr>
<tr>
<td><code>callfront</code></td>
<td>The callfront, called after properties are computed</td>
<td><code>callable</code></td>
<td></td>
<td>This chapter</td>
</tr>
</tbody>
</table>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Instead of using <code>setattr</code> (<code>pXXX.&lt;attrname&gt; = &lt;attrvalue&gt;</code>), Now you may also pass the <code>&lt;attrname&gt;</code> and <code>&lt;attrvalue&gt;</code> to the <code>Proc</code> constructor (since v1.0.1):
<div class="highlight"><pre><span></span><span class="n">pXXX</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">attrname</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">attrvalue</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div></p>
</div>
<h2 id="set-arguments-of-a-process-pxxxargs">Set arguments of a process <code>pXXX.args</code></h2>
<p>It is a <code>dict</code> used to set some common arguments shared within the process (different jobs). For example, all jobs use the same program: <code>bedtools</code>. but to make the process portable and shareable, you may want others can give a different path of <code>bedtools</code> as well. Then you can use <code>pXXX.args</code>:
<div class="highlight"><pre><span></span><span class="n">pXXX</span> <span class="o">=</span> <span class="n">Proc</span><span class="p">()</span>
<span class="n">pXXX</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infile1:file, infile2:file&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;file1.bed&quot;</span><span class="p">,</span> <span class="s2">&quot;file2.bed&quot;</span><span class="p">)]}</span>
<span class="n">pXXX</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;outfile:file:{{i.infile1 | fn}}.out&quot;</span>
<span class="n">pXXX</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bedtools&quot;</span><span class="p">:</span> <span class="s2">&quot;/path/to/bedtools&quot;</span><span class="p">}</span>
<span class="c1"># You can also do:</span>
<span class="c1"># pXXX.args.bedtools = &quot;/path/to/bedtools&quot;</span>
<span class="n">pXXX</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">{{args.bedtools}} intersect -a {{i.infile1}} -b {{i.infile2}} &gt; {{o.outfile}}</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
That's <strong>NOT</strong> recommended that you put it in the input channel:
<div class="highlight"><pre><span></span><span class="n">pXXX</span> <span class="o">=</span> <span class="n">proc</span><span class="p">()</span>
<span class="n">pXXX</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infile1:file, infile2:file, bedtools&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;file1.bed&quot;</span><span class="p">,</span> <span class="s2">&quot;file2.bed&quot;</span><span class="p">,</span> <span class="s2">&quot;/path/to/bedtools&quot;</span><span class="p">)]}</span>
<span class="n">pXXX</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;outfile:file:{{infile.fn}}.out&quot;</span>
<span class="n">pXXX</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">{{bedtools}} intersect -a {{infile1}} -b {{infile2}} &gt; {{outfile}}</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
Of course, you can do that, but a common argument is not usually generated from prior processes, then you have to modify the input channels. If the argument is a file, and you put it in <code>input</code> with type <code>file</code>, <code>PyPPL</code> will try to create a link in <code>&lt;indir&gt;</code>. If you have 100 jobs, we need to do that 100 times or to determine whether the link exists for 100 times. You may not want that to happen.  </p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Never use a key with dot <code>.</code> in <code>pXXX.args</code>, since we use <code>{{args.key}}</code> to access it. </p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><code>PyPPL</code> uses a built-in class <code>Box</code> to allow dot to be used to refer the attributes. So you can set the value of <code>args</code> like this: 
<div class="highlight"><pre><span></span><span class="n">pXXX</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">bedtools</span> <span class="o">=</span> <span class="s1">&#39;bedtools&#39;</span>
</pre></div></p>
</div>
<h2 id="set-the-valid-returnexit-codes-pxxxrc">Set the valid return/exit codes <code>pXXX.rc</code></h2>
<p>When a program exits, it will return a code (or <a href="https://en.wikipedia.org/wiki/Exit_status">exit status</a>), usually a small integer to exhibit it's status. Generally if a program finishes successfully, it will return <code>0</code>, which is the default value of <code>p.rc</code>. <code>pyppl</code> relies on this return code to determine whether a job finishes successfully.  If not, <code>p.errorhow</code> will be triggered. You can set multiple valid return codes for a process: 
<div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">rc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1">#or &quot;0,1&quot;</span>
<span class="c1"># exit code with 0 or 1 will be both regarded as success</span>
</pre></div></p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p><code>beforeCmd</code>/<code>afterCmd</code> only run locally, no matter which runner you choose to run the jobs.</p>
</div>
<h2 id="set-the-processes-current-process-depends-on-pxxxdepends">Set the processes current process depends on <code>pXXX.depends</code></h2>
<p>A process can not only depend on a single process: 
<div class="highlight"><pre><span></span><span class="n">p2</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p1</span>
</pre></div>
but also multiple processes 
<div class="highlight"><pre><span></span><span class="n">p2</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p0</span>
</pre></div>
To set prior processes not only let the process use the output channel as input for current process, but also determines when the process starts to run (right after the prior processes finish).</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>You can copy a process by <code>p2 = p.copy()</code>, but remember <code>depends</code> will not be copied, you have to specify it for the copied processes.  </p>
<p>When you specify new dependents for a process, its original ones will be removed, which means each time <code>pXXX.depends</code> will overwrite the previous setting.</p>
</div>
<h2 id="use-callback-to-modify-the-process-pxxxcallback">Use callback to modify the process <code>pXXX.callback</code></h2>
<p>The processes <strong>NOT</strong> initialized until it's ready to run. So you may not be able to modify some of the values until it is initialized. For example, you may want to change the output channel before it passes to the its dependent process:
<div class="highlight"><pre><span></span><span class="n">pSingle</span> <span class="o">=</span> <span class="n">Proc</span> <span class="p">()</span>
<span class="n">pSingle</span><span class="o">.</span><span class="n">input</span>    <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infile:file&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;file1.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;file2.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;file3.txt&quot;</span><span class="p">]}</span>
<span class="n">pSingle</span><span class="o">.</span><span class="n">output</span>   <span class="o">=</span> <span class="s2">&quot;outfile:file:{{i.infile | fn}}.sorted&quot;</span>
<span class="n">pSingle</span><span class="o">.</span><span class="n">script</span>   <span class="o">=</span> <span class="s2">&quot;# Sort {{i. infile}} and save to {{o.outfile}}.sorted&quot;</span>
<span class="c1"># pSingle.channel == [(&quot;file1.sorted&quot;,), (&quot;file2.sorted&quot;,), (&quot;file3.sorted&quot;,)]</span>
<span class="c1"># BUT NOT NOW!! the output channel is only generated after the process finishes</span>

<span class="n">pCombine</span> <span class="o">=</span> <span class="n">Proc</span> <span class="p">()</span>
<span class="n">pCombine</span><span class="o">.</span><span class="n">depends</span> <span class="o">=</span> <span class="n">pSingle</span>
<span class="n">pCombine</span><span class="o">.</span><span class="n">input</span>   <span class="o">=</span> <span class="s2">&quot;indir:file&quot;</span>   
<span class="c1"># the directory contains &quot;file1.sorted&quot;, &quot;file2.sorted&quot;, &quot;file3.sorted&quot;</span>
<span class="n">pCombine</span><span class="o">.</span><span class="n">output</span>  <span class="o">=</span> <span class="s2">&quot;outfile:{{i.indir | fn}}.combined&quot;</span>
<span class="n">pCombine</span><span class="o">.</span><span class="n">script</span>  <span class="o">=</span> <span class="s2">&quot;# combine files to {{o.outfile}}.combined&quot;</span>

<span class="c1"># To use the directory of &quot;file1.sorted&quot;, &quot;file2.sorted&quot;, &quot;file3.sorted&quot; as the input channel for pCombine</span>
<span class="c1"># You can use callback</span>
<span class="k">def</span> <span class="nf">pSingleCallback</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">collapse</span><span class="p">()</span>
<span class="n">pSingle</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="n">pSingleCallback</span>

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span> <span class="p">(</span><span class="n">pSingle</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
You can also use a callback in <code>pCombine.input</code> to modify the channel, see <a href="./specify-input-and-output-of-a-process/#use-a-callback-to-modify-the-output-channel-of-the-prior-process">here</a>, which is recommended. Because <code>p.callback</code> will change the original output channel of <code>pSingle</code>, but the <code>input</code> callback will keep the output channel intact. However, <code>p.callback</code> can not only change the output channel, but also change other properties of current process or even set the properties of coming processes.</p>
<h2 id="use-callfront-to-modify-the-process-pxxxcallfront">Use callfront to modify the process <code>pXXX.callfront</code></h2>
<p>One possible scenario is that, value in  <code>pXXX.args</code> depends on the other process.
For example:
<div class="highlight"><pre><span></span><span class="c1"># generate bam files</span>
<span class="c1"># ...</span>
<span class="n">pBam</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;bamfile:file:{{i.infile | fn}}.bam&quot;</span>

<span class="c1"># generate/download reference file, and index it</span>
<span class="c1"># ...</span>
<span class="n">pRef</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;reffile:file:{{i.in}}.fa&quot;</span>

<span class="c1"># call variance</span>
<span class="c1"># ...</span>
<span class="n">pCall</span><span class="o">.</span><span class="n">depends</span>   <span class="o">=</span> <span class="n">pBam</span><span class="p">,</span> <span class="n">pRef</span>
<span class="n">pCall</span><span class="o">.</span><span class="n">callfront</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;reffile&#39;</span><span class="p">:</span> <span class="n">pRef</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">reffile</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]})</span>

<span class="c1"># pCall also depends on pRef, as it needs the reference file to run. </span>
<span class="c1"># But you may not want to put it in input.</span>

<span class="n">PyPPL</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">pBam</span><span class="p">,</span> <span class="n">pRef</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../error-handling/" title="Error handling of processes" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Error handling of processes
              </span>
            </div>
          </a>
        
        
          <a href="../configure-your-logs/" title="Log configuration" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Log configuration
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b3a2063f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>